<!doctype html>
<html lang="tr">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title id="pageTitle">√úr√ºn - Butik Maƒüaza</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Poppins:wght@300;400;500;600;700&family=Playfair+Display:wght@400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
      tailwind.config = {
        theme: {
          extend: {
            fontFamily: {
              sans: ['Inter', 'Poppins', 'system-ui', 'sans-serif'],
              display: ['Playfair Display', 'serif']
            },
            colors: {
              champagne: {
                50: '#FEFCF7',
                100: '#FDF8ED',
                200: '#FBF0D6',
                300: '#F8E4B8',
                400: '#F4D494',
                500: '#F0C270',
                600: '#E8A94A',
                700: '#D18F2E',
                800: '#A87225',
                900: '#8A5F22'
              },
              gold: {
                50: '#FFFBEB',
                100: '#FEF3C7',
                200: '#FDE68A',
                300: '#FCD34D',
                400: '#FBBF24',
                500: '#F59E0B',
                600: '#D97706',
                700: '#B45309',
                800: '#92400E',
                900: '#78350F'
              },
              pastel: {
                pink: '#FCE7F3',
                lavender: '#F3E8FF',
                blue: '#DBEAFE',
                green: '#D1FAE5',
                yellow: '#FEF3C7'
              }
            },
            animation: {
              'fade-in': 'fadeIn 0.6s ease-out',
              'slide-up': 'slideUp 0.6s ease-out'
            },
            keyframes: {
              fadeIn: {
                '0%': { opacity: '0', transform: 'translateY(20px)' },
                '100%': { opacity: '1', transform: 'translateY(0)' }
              },
              slideUp: {
                '0%': { opacity: '0', transform: 'translateY(40px)' },
                '100%': { opacity: '1', transform: 'translateY(0)' }
              }
            }
          }
        }
      }
    </script>
    <style>
      .glass-effect {
        backdrop-filter: blur(20px);
        background: rgba(255, 255, 255, 0.25);
        border: 1px solid rgba(255, 255, 255, 0.18);
      }
      .glass-card {
        backdrop-filter: blur(16px);
        background: rgba(255, 255, 255, 0.7);
        border: 1px solid rgba(255, 255, 255, 0.3);
      }
      .gradient-text {
        background: linear-gradient(135deg, #F59E0B, #D97706, #B45309);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
      }
      .product-image {
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      }
      .product-image:hover {
        transform: scale(1.05);
      }
      .size-badge {
        transition: all 0.2s ease;
      }
      .size-badge:hover {
        transform: translateY(-2px);
        box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
      }
      .whatsapp-float {
        animation: float 3s ease-in-out infinite;
      }
      @keyframes float {
        0%, 100% { transform: translateY(0px); }
        50% { transform: translateY(-10px); }
      }
      
      /* Varyant sistemi i√ßin stiller */
      .variant-card {
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      }
      
      .variant-card:hover {
        transform: translateY(-2px);
        box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
      }
      
      .variant-card.selected {
        border-color: #F59E0B;
        background-color: #FEF3C7;
        box-shadow: 0 4px 20px rgba(245, 158, 11, 0.2);
      }
      
      .variant-image {
        transition: all 0.3s ease;
      }
      
      .variant-image:hover {
        transform: scale(1.05);
      }
      
      .variant-size-badge {
        transition: all 0.2s ease;
      }
      
      .variant-size-badge:hover {
        background-color: #FEF3C7;
        border-color: #F59E0B;
        color: #92400E;
      }
      
      /* Resim Galerisi Stilleri */
      .gallery-nav-btn {
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      }
      
      .gallery-nav-btn:hover {
        transform: scale(1.1);
        box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
      }
      
      .image-dot {
        transition: all 0.3s ease;
      }
      
      .image-dot:hover {
        transform: scale(1.2);
      }
      
      .image-dot.active {
        background-color: #F59E0B !important;
        transform: scale(1.3);
      }
    </style>
  </head>
  <body class="bg-gradient-to-br from-champagne-50 via-pastel-pink to-pastel-lavender min-h-screen">
    <!-- Header -->
    <header class="glass-effect sticky top-0 z-50 border-b border-white/20">
      <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <div class="flex items-center justify-between h-16">
          <!-- Logo -->
          <a href="/" class="flex items-center space-x-3">
            <div class="w-10 h-10 bg-gradient-to-br from-gold-400 to-gold-600 rounded-xl flex items-center justify-center">
              <span class="text-white font-display font-bold text-xl">B</span>
            </div>
            <span class="text-2xl font-display font-semibold gradient-text">HTM MODA</span>
          </a>

          <!-- Search Bar - Desktop -->
          <div class="hidden md:flex flex-1 max-w-md mx-8">
            <div class="relative w-full">
              <input 
                type="text" 
                id="searchInput"
                placeholder="√úr√ºn ara..." 
                class="w-full px-4 py-2 pl-10 glass-card rounded-xl border-0 focus:ring-2 focus:ring-gold-400 focus:outline-none transition-all duration-300"
              >
              <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                <svg class="h-5 w-5 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
                </svg>
              </div>
            </div>
          </div>

          <!-- Right Side - Desktop -->
          <div class="hidden md:flex items-center space-x-4">
            <!-- Admin link removed -->
          </div>

          <!-- Mobile Menu Button -->
          <div class="md:hidden flex items-center space-x-3">
            <button id="mobileMenuBtn" class="p-2 rounded-lg text-gray-600 hover:text-gray-800 hover:bg-white/20 transition-colors">
              <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
              </svg>
            </button>
          </div>
        </div>

        <!-- Mobile Search Bar -->
        <div id="mobileSearch" class="md:hidden pb-4 hidden">
          <div class="relative w-full">
            <input 
              type="text" 
              id="mobileSearchInput"
              placeholder="√úr√ºn ara..." 
              class="w-full px-4 py-2 pl-10 glass-card rounded-xl border-0 focus:ring-2 focus:ring-gold-400 focus:outline-none transition-all duration-300"
            >
            <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
              <svg class="h-5 w-5 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
              </svg>
            </div>
          </div>
        </div>
      </div>
    </header>

    <!-- Mobile Menu -->
    <div id="mobileMenu" class="md:hidden fixed inset-0 z-40 bg-black/50 hidden">
      <div class="bg-white h-full w-80 max-w-[80vw] shadow-xl transform transition-transform duration-300">
        <div class="flex items-center justify-between p-4 border-b">
          <span class="text-lg font-semibold text-gray-800">Men√º</span>
          <button id="closeMobileMenu" class="p-2 rounded-lg text-gray-600 hover:text-gray-800 hover:bg-gray-100">
            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
            </svg>
          </button>
        </div>
        <div class="p-4 space-y-4">
          <a href="/" class="block py-3 px-4 rounded-lg text-gray-700 hover:bg-gray-100 hover:text-gold-600 transition-colors">
            Ana Sayfa
          </a>
          <a href="#productInfo" class="block py-3 px-4 rounded-lg text-gray-700 hover:bg-gray-100 hover:text-gold-600 transition-colors">
            √úr√ºn Bilgileri
          </a>
          <div class="border-t pt-4">
            <!-- Admin Giri≈ü link removed -->
          </div>
        </div>
      </div>
    </div>

    <!-- Breadcrumb -->
    <section class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4">
      <nav class="flex items-center gap-2 text-sm text-gray-600">
        <a href="/" class="hover:text-gray-800 transition-colors duration-200">Ana Sayfa</a>
        <span>/</span>
        <a href="#" id="categoryLink" class="hover:text-gray-800 transition-colors duration-200">Kategori</a>
        <span>/</span>
        <span id="productName" class="text-gray-800 font-medium">√úr√ºn</span>
      </nav>
    </section>



    <!-- Product Detail Section -->
    <section class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
      <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 lg:gap-12">
        <!-- Product Image Gallery -->
        <div class="animate-fade-in">
          <div class="space-y-4">
            <!-- √úr√ºn Adƒ± -->
            <div class="mb-4">
              <h1 id="imageProductTitle" class="text-2xl sm:text-3xl md:text-4xl lg:text-5xl font-display font-bold text-gray-800 leading-tight">
                √úr√ºn Adƒ±
              </h1>
            </div>
            
            <!-- Main Image -->
            <div class="relative overflow-hidden rounded-2xl shadow-2xl group">
              <img 
                id="productImage" 
                src="" 
                alt="√úr√ºn G√∂rseli" 
                class="w-full h-auto max-h-[80vh] object-contain product-image cursor-pointer"
                onclick="openImageModal(this.src)"
              >
              <div class="absolute top-4 right-4">
                <span id="categoryBadge" class="px-3 py-1 bg-gradient-to-r from-gold-400 to-gold-600 text-white text-sm font-medium rounded-full shadow-lg">
                  Kategori
                </span>
              </div>
              
              <!-- Navigation Buttons -->
              <button id="prevImageBtn" onclick="previousImage()" class="gallery-nav-btn absolute left-4 top-1/2 transform -translate-y-1/2 w-12 h-12 bg-white/90 backdrop-blur-sm rounded-full flex items-center justify-center opacity-0 group-hover:opacity-100 transition-all duration-300 hover:bg-white shadow-lg">
                <svg class="w-6 h-6 text-gray-600" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" d="M15 19l-7-7 7-7"/>
                </svg>
              </button>
              
              <button id="nextImageBtn" onclick="nextImage()" class="gallery-nav-btn absolute right-4 top-1/2 transform -translate-y-1/2 w-12 h-12 bg-white/90 backdrop-blur-sm rounded-full flex items-center justify-center opacity-0 group-hover:opacity-100 transition-all duration-300 hover:bg-white shadow-lg">
                <svg class="w-6 h-6 text-gray-600" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" d="M9 5l7 7-7 7"/>
                </svg>
              </button>
              
              <!-- Image Counter -->
              <div class="absolute bottom-4 left-4 bg-black/50 backdrop-blur-sm rounded-full px-3 py-1 text-white text-sm font-medium">
                <span id="imageCounter">1 / 1</span>
              </div>
              
              <!-- Image Dots Indicator -->
              <div id="imageDots" class="absolute bottom-4 left-1/2 transform -translate-x-1/2 flex space-x-2">
                <!-- Dots will be generated here -->
              </div>
              
              <!-- Zoom Icon -->
              <div class="absolute bottom-4 right-4 w-10 h-10 bg-white/90 backdrop-blur-sm rounded-full flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity duration-300">
                <svg class="w-5 h-5 text-gray-600" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0zM10 7v3m0 0v3m0-3h3m-3 0H7"/>
                </svg>
              </div>
            </div>
            
            <!-- Thumbnail Gallery -->
            <div id="thumbnailGallery" class="grid grid-cols-4 gap-3">
              <!-- Thumbnails will be loaded here -->
            </div>
          </div>
        </div>

        <!-- Product Info -->
        <div class="animate-slide-up">
          
          <div class="mb-6">
            <span id="productPrice" class="text-3xl font-bold gradient-text" style="display: block !important; visibility: visible !important; opacity: 1 !important;">‚Ç∫0</span>
          </div>

          <div class="mb-6">
            <h3 class="text-lg font-semibold text-gray-700 mb-3">A√ßƒ±klama</h3>
            <p id="productDescription" class="text-gray-600 leading-relaxed">
              √úr√ºn a√ßƒ±klamasƒ± burada yer alacak...
            </p>
          </div>

          <!-- Color Variants -->
          <div id="colorVariantsSection" class="mb-8" style="display: block;">
            <h3 class="text-lg font-semibold text-gray-700 mb-3">Renk Se√ßenekleri</h3>
            <div class="flex items-center gap-3 mb-4">
              <span class="text-sm text-gray-600">Se√ßili Renk:</span>
              <span id="selectedColorName" class="text-sm font-medium text-gray-800">-</span>
            </div>
            <div id="colorVariantsContainer" class="flex flex-wrap gap-3">
              <!-- Renk varyantlarƒ± buraya dinamik olarak eklenecek -->
            </div>
          </div>



          <!-- Size Selection -->
          <div class="mb-8">
            <h3 class="text-lg font-semibold text-gray-700 mb-3">Beden Se√ßimi</h3>
            <div id="sizeContainer" class="flex flex-wrap gap-3">
              <!-- Se√ßili renge ait bedenler buraya y√ºklenecek -->
            </div>
          </div>

          <!-- Stock Information -->
          <div class="mb-8">
            <h3 class="text-lg font-semibold text-gray-700 mb-3">Stok Durumu</h3>
            <div id="stockContainer" class="bg-gray-50 rounded-xl p-4">
              <div class="flex items-center gap-3">
                <div class="w-3 h-3 rounded-full bg-green-500"></div>
                <span id="stockText" class="text-sm text-gray-700">Stok durumu se√ßilen renge g√∂re deƒüi≈üir</span>
              </div>
            </div>
          </div>

          <!-- Product Features -->
          <div class="mb-8">
            <h3 class="text-lg font-semibold text-gray-700 mb-3">√úr√ºn √ñzellikleri</h3>
            <div class="grid grid-cols-2 gap-4">
              <div class="flex items-center gap-3 p-3 bg-gray-50 rounded-xl">
                <div class="w-8 h-8 bg-gold-100 rounded-lg flex items-center justify-center">
                  <svg class="w-4 h-4 text-gold-600" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"/>
                  </svg>
                </div>
                <div>
                  <p class="text-sm font-medium text-gray-700">Kaliteli Kuma≈ü</p>
                  <p class="text-xs text-gray-500">Premium malzeme</p>
                </div>
              </div>
              
              <div class="flex items-center gap-3 p-3 bg-gray-50 rounded-xl">
                <div class="w-8 h-8 bg-gold-100 rounded-lg flex items-center justify-center">
                  <svg class="w-4 h-4 text-gold-600" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M7 21a4 4 0 01-4-4V5a2 2 0 012-2h4a2 2 0 012 2v12a4 4 0 01-4 4zm0 0h12a2 2 0 002-2v-4a2 2 0 00-2-2h-2.343M11 7.343l1.657-1.657a2 2 0 012.828 0l2.829 2.829a2 2 0 010 2.828l-8.486 8.485M7 17h.01"/>
                  </svg>
                </div>
                <div>
                  <p class="text-sm font-medium text-gray-700">√ñzel Tasarƒ±m</p>
                  <p class="text-xs text-gray-500">Benzersiz stil</p>
                </div>
              </div>
              
              <div class="flex items-center gap-3 p-3 bg-gray-50 rounded-xl">
                <div class="w-8 h-8 bg-gold-100 rounded-lg flex items-center justify-center">
                  <svg class="w-4 h-4 text-gold-600" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"/>
                  </svg>
                </div>
                <div>
                  <p class="text-sm font-medium text-gray-700">Hƒ±zlƒ± Teslimat</p>
                  <p class="text-xs text-gray-500">1-3 i≈ü g√ºn√º</p>
                </div>
              </div>
              
              <div class="flex items-center gap-3 p-3 bg-gray-50 rounded-xl">
                <div class="w-8 h-8 bg-gold-100 rounded-lg flex items-center justify-center">
                  <svg class="w-4 h-4 text-gold-600" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"/>
                  </svg>
                </div>
                <div>
                  <p class="text-sm font-medium text-gray-700">G√ºvenli Alƒ±≈üveri≈ü</p>
                  <p class="text-xs text-gray-500">SSL korumalƒ±</p>
                </div>
              </div>
            </div>
          </div>

          <!-- Product Specifications -->
          <div class="mb-8">
            <h3 class="text-lg font-semibold text-gray-700 mb-3">√úr√ºn Bilgileri</h3>
            <div class="bg-gray-50 rounded-xl p-4">
              <table class="w-full">
                <tbody class="space-y-2">
                  <tr class="flex justify-between py-2 border-b border-gray-200">
                    <td class="text-sm text-gray-600 font-medium">Kategori</td>
                    <td id="productCategory" class="text-sm text-gray-800">-</td>
                  </tr>
                  <tr class="flex justify-between py-2 border-b border-gray-200">
                    <td class="text-sm text-gray-600 font-medium">Malzeme</td>
                    <td class="text-sm text-gray-800">%100 Pamuk</td>
                  </tr>
                  <tr class="flex justify-between py-2 border-b border-gray-200">
                    <td class="text-sm text-gray-600 font-medium">Bakƒ±m</td>
                    <td class="text-sm text-gray-800">30¬∞C'de yƒ±kayƒ±n</td>
                  </tr>
                  <tr class="flex justify-between py-2 border-b border-gray-200">
                    <td class="text-sm text-gray-600 font-medium">√úretim</td>
                    <td class="text-sm text-gray-800">T√ºrkiye</td>
                  </tr>
                  <tr class="flex justify-between py-2">
                    <td class="text-sm text-gray-600 font-medium">Garanti</td>
                    <td class="text-sm text-gray-800">2 Yƒ±l</td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>

          <!-- WhatsApp Order Button -->
          <div class="mb-6">
            <a 
              id="whatsappOrderBtn"
              href="#" 
              target="_blank"
              class="inline-flex items-center justify-center w-full px-8 py-4 bg-green-500 hover:bg-green-600 text-white font-semibold rounded-xl shadow-lg hover:shadow-xl transform hover:-translate-y-1 transition-all duration-300 text-lg"
            >
              <svg class="w-6 h-6 mr-3" fill="currentColor" viewBox="0 0 24 24">
                <path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.87 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-6.33 11.893-11.893A11.821 11.821 0 0020.885 3.488"/>
              </svg>
              WhatsApp ile Sipari≈ü Ver
            </a>
          </div>

          <!-- Social Media Share -->
          <div class="mb-6">
            <h3 class="text-lg font-semibold text-gray-700 mb-3">Arkada≈ülarƒ±nla Payla≈ü</h3>
            <div class="flex gap-3">
              <button onclick="shareOnFacebook()" class="flex-1 px-4 py-3 bg-blue-600 hover:bg-blue-700 text-white font-medium rounded-xl transition-colors duration-300 flex items-center justify-center gap-2">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24">
                  <path d="M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"/>
                </svg>
                Facebook
              </button>
              
              <button onclick="shareOnWhatsApp()" class="flex-1 px-4 py-3 bg-green-500 hover:bg-green-600 text-white font-medium rounded-xl transition-colors duration-300 flex items-center justify-center gap-2">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24">
                  <path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893A11.821 11.821 0 0020.885 3.488"/>
                </svg>
                WhatsApp
              </button>
            </div>
          </div>

          <!-- Back to Category Button -->
          <div>
            <a 
              id="backToCategoryBtn"
              href="#" 
              class="inline-flex items-center px-6 py-3 border border-gray-300 text-gray-600 hover:bg-gray-50 hover:border-gold-400 transition-all duration-300 rounded-xl font-medium"
            >
              ‚Üê Kategoriye D√∂n
            </a>
          </div>
        </div>
      </div>
    </section>

    <!-- Customer Reviews Section -->
    <section class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-16">
      <div class="text-center mb-12">
        <h2 class="text-3xl font-display font-bold text-gray-800 mb-4">M√º≈üteri Yorumlarƒ±</h2>
        <p class="text-gray-600 max-w-2xl mx-auto">M√º≈üterilerimizin deneyimlerini okuyun ve √ºr√ºn hakkƒ±nda daha fazla bilgi edinin.</p>
      </div>
      
      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
        <!-- Review 1 -->
        <div class="bg-white rounded-2xl p-6 shadow-lg hover:shadow-xl transition-all duration-300">
          <div class="flex items-center mb-4">
            <div class="w-12 h-12 bg-gradient-to-br from-gold-400 to-gold-600 rounded-full flex items-center justify-center text-white font-bold text-lg mr-4">
              A
            </div>
            <div>
              <h4 class="font-semibold text-gray-800">Ay≈üe K.</h4>
              <div class="flex items-center">
                <div class="flex text-gold-400">
                  <svg class="w-4 h-4 fill-current" viewBox="0 0 24 24"><path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/></svg>
                  <svg class="w-4 h-4 fill-current" viewBox="0 0 24 24"><path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/></svg>
                  <svg class="w-4 h-4 fill-current" viewBox="0 0 24 24"><path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/></svg>
                  <svg class="w-4 h-4 fill-current" viewBox="0 0 24 24"><path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/></svg>
                  <svg class="w-4 h-4 fill-current" viewBox="0 0 24 24"><path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/></svg>
                </div>
                <span class="text-sm text-gray-500 ml-2">5.0</span>
              </div>
            </div>
          </div>
          <p class="text-gray-600 leading-relaxed">"Harika kalitede bir √ºr√ºn! Tam beklediƒüim gibi geldi. Kuma≈ü √ßok yumu≈üak ve rahat. Kesinlikle tavsiye ederim."</p>
        </div>

        <!-- Review 2 -->
        <div class="bg-white rounded-2xl p-6 shadow-lg hover:shadow-xl transition-all duration-300">
          <div class="flex items-center mb-4">
            <div class="w-12 h-12 bg-gradient-to-br from-champagne-400 to-champagne-600 rounded-full flex items-center justify-center text-white font-bold text-lg mr-4">
              M
            </div>
            <div>
              <h4 class="font-semibold text-gray-800">Mehmet S.</h4>
              <div class="flex items-center">
                <div class="flex text-gold-400">
                  <svg class="w-4 h-4 fill-current" viewBox="0 0 24 24"><path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/></svg>
                  <svg class="w-4 h-4 fill-current" viewBox="0 0 24 24"><path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/></svg>
                  <svg class="w-4 h-4 fill-current" viewBox="0 0 24 24"><path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/></svg>
                  <svg class="w-4 h-4 fill-current" viewBox="0 0 24 24"><path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/></svg>
                  <svg class="w-4 h-4 fill-current" viewBox="0 0 24 24"><path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/></svg>
                </div>
                <span class="text-sm text-gray-500 ml-2">5.0</span>
              </div>
            </div>
          </div>
          <p class="text-gray-600 leading-relaxed">"√áok hƒ±zlƒ± kargo ve m√ºkemmel paketleme. √úr√ºn kalitesi ger√ßekten √ßok iyi. Tekrar alacaƒüƒ±m."</p>
        </div>

        <!-- Review 3 -->
        <div class="bg-white rounded-2xl p-6 shadow-lg hover:shadow-xl transition-all duration-300">
          <div class="flex items-center mb-4">
            <div class="w-12 h-12 bg-gradient-to-br from-pastel-blue to-blue-500 rounded-full flex items-center justify-center text-white font-bold text-lg mr-4">
              F
            </div>
            <div>
              <h4 class="font-semibold text-gray-800">Fatma Y.</h4>
              <div class="flex items-center">
                <div class="flex text-gold-400">
                  <svg class="w-4 h-4 fill-current" viewBox="0 0 24 24"><path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/></svg>
                  <svg class="w-4 h-4 fill-current" viewBox="0 0 24 24"><path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/></svg>
                  <svg class="w-4 h-4 fill-current" viewBox="0 0 24 24"><path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/></svg>
                  <svg class="w-4 h-4 fill-current" viewBox="0 0 24 24"><path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/></svg>
                  <svg class="w-4 h-4 fill-current" viewBox="0 0 24 24"><path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/></svg>
                </div>
                <span class="text-sm text-gray-500 ml-2">5.0</span>
              </div>
            </div>
          </div>
          <p class="text-gray-600 leading-relaxed">"Tasarƒ±m √ßok ≈üƒ±k ve modern. Arkada≈ülarƒ±m da √ßok beƒüendi. Kalite-fiyat oranƒ± m√ºkemmel."</p>
        </div>
      </div>
    </section>

    <!-- FAQ Section -->
    <section class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-16">
      <div class="text-center mb-12">
        <h2 class="text-3xl font-display font-bold text-gray-800 mb-4">Sƒ±k Sorulan Sorular</h2>
        <p class="text-gray-600 max-w-2xl mx-auto">√úr√ºn hakkƒ±nda merak edilen sorular ve cevaplarƒ±.</p>
      </div>
      
      <div class="max-w-3xl mx-auto space-y-4">
        <!-- FAQ Item 1 -->
        <div class="bg-white rounded-xl shadow-lg overflow-hidden">
          <button onclick="toggleFAQ(this)" class="w-full px-6 py-4 text-left flex items-center justify-between hover:bg-gray-50 transition-colors duration-200">
            <span class="font-medium text-gray-800">Bu √ºr√ºn hangi bedenlerde mevcut?</span>
            <svg class="w-5 h-5 text-gray-500 transform transition-transform duration-200" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" d="M19 9l-7 7-7-7"/>
            </svg>
          </button>
          <div class="hidden px-6 pb-4">
            <p class="text-gray-600">√úr√ºn√ºm√ºz XS, S, M, L, XL ve XXL bedenlerinde mevcuttur. Detaylƒ± beden bilgisi i√ßin √ºr√ºn sayfasƒ±ndaki beden tablosunu inceleyebilirsiniz.</p>
          </div>
        </div>

        <!-- FAQ Item 2 -->
        <div class="bg-white rounded-xl shadow-lg overflow-hidden">
          <button onclick="toggleFAQ(this)" class="w-full px-6 py-4 text-left flex items-center justify-between hover:bg-gray-50 transition-colors duration-200">
            <span class="font-medium text-gray-800">Kargo s√ºresi ne kadar?</span>
            <svg class="w-5 h-5 text-gray-500 transform transition-transform duration-200" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" d="M19 9l-7 7-7-7"/>
            </svg>
          </button>
          <div class="hidden px-6 pb-4">
            <p class="text-gray-600">Sipari≈üiniz onaylandƒ±ktan sonra 1-3 i≈ü g√ºn√º i√ßerisinde kargoya verilmektedir. Teslimat s√ºresi bulunduƒüunuz b√∂lgeye g√∂re 1-2 i≈ü g√ºn√º s√ºrmektedir.</p>
          </div>
        </div>

        <!-- FAQ Item 3 -->
        <div class="bg-white rounded-xl shadow-lg overflow-hidden">
          <button onclick="toggleFAQ(this)" class="w-full px-6 py-4 text-left flex items-center justify-between hover:bg-gray-50 transition-colors duration-200">
            <span class="font-medium text-gray-800">ƒ∞ade ve deƒüi≈üim ko≈üullarƒ± nelerdir?</span>
            <svg class="w-5 h-5 text-gray-500 transform transition-transform duration-200" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" d="M19 9l-7 7-7-7"/>
            </svg>
          </button>
          <div class="hidden px-6 pb-4">
            <p class="text-gray-600">√úr√ºn√º teslim aldƒ±ƒüƒ±nƒ±z tarihten itibaren 14 g√ºn i√ßerisinde iade edebilir veya deƒüi≈ütirebilirsiniz. √úr√ºn orijinal ambalajƒ±nda ve kullanƒ±lmamƒ±≈ü olmalƒ±dƒ±r.</p>
          </div>
        </div>

        <!-- FAQ Item 4 -->
        <div class="bg-white rounded-xl shadow-lg overflow-hidden">
          <button onclick="toggleFAQ(this)" class="w-full px-6 py-4 text-left flex items-center justify-between hover:bg-gray-50 transition-colors duration-200">
            <span class="font-medium text-gray-800">√ñdeme se√ßenekleri nelerdir?</span>
            <svg class="w-5 h-5 text-gray-500 transform transition-transform duration-200" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" d="M19 9l-7 7-7-7"/>
            </svg>
          </button>
          <div class="hidden px-6 pb-4">
            <p class="text-gray-600">Kapƒ±da √∂deme, banka kartƒ±, kredi kartƒ± ve havale/EFT ile √∂deme yapabilirsiniz. T√ºm √∂demeler g√ºvenli SSL sertifikasƒ± ile korunmaktadƒ±r.</p>
          </div>
        </div>
      </div>
    </section>

    <!-- Active Campaign Banner (only if exists) -->
    <div id="activeCampaignBar" class="hidden bg-gradient-to-r from-gold-100 to-pastel-pink/40 border-b border-champagne-200/70">
      <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-3 flex items-center justify-between gap-3 cursor-pointer">
        <div class="flex items-center gap-3">
          <div class="w-8 h-8 rounded-lg bg-gold-500 text-white flex items-center justify-center">%</n+          </div>
          <div class="text-sm sm:text-base text-gray-800">
            <span id="activeCampaignText" class="font-medium"></span>
          </div>
        </div>
        <div class="text-gold-700 text-sm">Kampanyayƒ± G√∂r ‚Üí</div>
      </div>
    </div>

    <!-- Image Modal -->
    <div id="imageModal" class="fixed inset-0 bg-black/90 hidden items-center justify-center z-50 p-4">
      <div class="relative max-w-4xl max-h-full">
        <img id="modalImage" src="" alt="B√ºy√ºk G√∂rsel" class="max-w-full max-h-full object-contain rounded-lg" />
        <button onclick="closeImageModal()" class="absolute top-4 right-4 w-10 h-10 bg-white/20 backdrop-blur-sm rounded-full flex items-center justify-center text-white hover:bg-white/30 transition-colors duration-200">
          <svg class="w-6 h-6" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12"/>
          </svg>
        </button>
      </div>
    </div>

    <!-- Similar Products Section -->
    <section class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-16">
      <div class="text-center mb-12">
        <h2 class="text-3xl font-display font-bold text-gray-800 mb-4">Benzer √úr√ºnler</h2>
        <p class="text-gray-600 max-w-2xl mx-auto">Bu kategoriye ait diƒüer √ºr√ºnleri ke≈üfedin ve koleksiyonunuzu geni≈ületin.</p>
      </div>
      
      <div id="similarProductsGrid" class="grid gap-6" style="grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));">
        <!-- Similar products will be loaded here -->
      </div>
    </section>




    <!-- WhatsApp Float Button -->
    <div class="fixed bottom-4 right-4 md:bottom-6 md:right-6 z-50">
      <a 
        id="whatsappFloatBtn"
        href="https://wa.me/905065668854" 
        target="_blank" 
        class="whatsapp-float bg-green-500 hover:bg-green-600 text-white p-3 md:p-4 rounded-full shadow-lg hover:shadow-xl transition-all duration-300 flex items-center justify-center"
        title="WhatsApp ile ileti≈üim"
      >
        <svg class="w-5 h-5 md:w-6 md:h-6" fill="currentColor" viewBox="0 0 24 24">
          <path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.87 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-6.33 11.893-11.893A11.821 11.821 0 0020.885 3.488"/>
        </svg>
      </a>
    </div>

    <!-- Scripts -->
    <script src="/js/config.js"></script>
    <script>
      // Aktif kampanya barƒ±
      (async () => {
        try {
          const res = await fetch('/api/campaigns');
          const list = await res.json();
          if (Array.isArray(list) && list.length > 0) {
            const c = list[0];
            const bar = document.getElementById('activeCampaignBar');
            const txt = document.getElementById('activeCampaignText');
            if (bar && txt) {
              txt.textContent = c.name || 'Kampanya';
              bar.classList.remove('hidden');
              bar.onclick = () => window.location.href = `/category?campaignId=${c._id}`;
            }
          }
        } catch (_) {}
      })();

      // G√∂rsel kaynaƒüƒ±nƒ± g√ºvenli ≈üekilde elde et (string veya {url})
      function getImageSrc(img) {
        if (!img) return '';
        try {
          const raw = (typeof img === 'object' && img.url) ? img.url : String(img);
          // G√ºvenli d√ºzeltme: '/uploads/https...' gibi yanlƒ±≈ü √∂nekleri temizle
          if (raw.startsWith('/uploads/http')) {
            return raw.replace(/^\/uploads\//, '');
          }
          return raw;
        } catch (_) {
          return '';
        }
      }
      // Get product ID from URL path
      const pathParts = window.location.pathname.split('/');
      const productId = pathParts[pathParts.length - 1];
      
      console.log('üîç URL path parts:', pathParts);
      console.log('üÜî Extracted product ID:', productId);
      
      if (productId && productId !== 'product' && productId !== '') {
        console.log('‚úÖ √úr√ºn detaylarƒ± y√ºkleniyor...');
        loadProductDetails(productId);
      } else {
        console.error('‚ùå Ge√ßersiz √ºr√ºn ID:', productId);
        showProductError('Ge√ßersiz √ºr√ºn ID. L√ºtfen ana sayfadan tekrar deneyin.');
      }

      async function loadProductDetails(productId) {
        try {
          console.log('üîÑ √úr√ºn detaylarƒ± y√ºkleniyor, ID:', productId);
          console.log('üîç Mevcut DOM durumu:', {
            productName: !!document.getElementById('productName'),
            imageProductTitle: !!document.getElementById('imageProductTitle'),
            productDescription: !!document.getElementById('productDescription'),
            productPrice: !!document.getElementById('productPrice'),
            productImage: !!document.getElementById('productImage'),
            thumbnailGallery: !!document.getElementById('thumbnailGallery')
          });
          
          if (!productId || productId === 'product' || productId === '') {
            throw new Error('Ge√ßersiz √ºr√ºn ID');
          }
          
          console.log('üåê API √ßaƒürƒ±sƒ± yapƒ±lƒ±yor:', `/api/products/${productId}`);
          const response = await fetch(`/api/products/${productId}`);
          
          console.log('üì° API yanƒ±tƒ±:', response.status, response.statusText);
          
          if (!response.ok) {
            const errorText = await response.text();
            console.error('‚ùå API hata detayƒ±:', errorText);
            throw new Error(`HTTP ${response.status}: ${response.statusText}`);
          }
          
          const product = await response.json();
          console.log('‚úÖ √úr√ºn verisi alƒ±ndƒ±:', product);
          console.log('üîç √úr√ºn veri yapƒ±sƒ±:', {
            id: product._id,
            name: product.name,
            price: product.price,
            description: product.description,
            imageUrl: product.imageUrl,
            images: product.images,
            categoryId: product.categoryId
          });
          
          if (!product || !product._id) {
            throw new Error('√úr√ºn verisi bulunamadƒ±');
          }
          
          console.log('üé® √úr√ºn g√∂r√ºnt√ºleniyor...');
          displayProduct(product);
          console.log('‚úÖ √úr√ºn g√∂r√ºnt√ºleme tamamlandƒ±');
          
          // Varyantlarƒ± y√ºkle
          console.log('üîÑ Varyantlar y√ºkleniyor...');
          await loadProductVariants(productId);
          console.log('‚úÖ Varyantlar y√ºklendi');
        } catch (error) {
          console.error('‚ùå √úr√ºn y√ºklenirken hata:', error);
          showProductError(`√úr√ºn y√ºklenirken hata olu≈ütu: ${error.message}`);
        }
      }

      function displayProduct(product) {
        console.log('üé® √úr√ºn g√∂r√ºnt√ºleniyor:', product);
        console.log('üîç √úr√ºn varyantlarƒ±:', product.variants);
        console.log('üé® √úr√ºn renk varyantlarƒ±:', product.colorVariants);
        console.log('üîç √úr√ºn ID:', product._id);
        console.log('üîç √úr√ºn adƒ±:', product.name);
        console.log('üîç √úr√ºn fiyatƒ±:', product.price);
        console.log('üîç √úr√ºn a√ßƒ±klamasƒ±:', product.description);
        console.log('üîç √úr√ºn g√∂rseli:', product.imageUrl);
        console.log('üîç √úr√ºn g√∂rselleri:', product.images);
        
        // Veri k√ºmesini globalde tut
        currentProduct = product;
        
        // Update page title
        const productName = product.productName || product.name || '√úr√ºn Adƒ±';
        console.log('üìù √úr√ºn adƒ±:', productName);
        document.title = `${productName} - Butik Maƒüaza`;
        
        // Update breadcrumb
        const productNameElement = document.getElementById('productName');
        console.log('üîç Breadcrumb element bulundu:', !!productNameElement);
        if (productNameElement) {
          productNameElement.textContent = productName;
          console.log('‚úÖ Breadcrumb g√ºncellendi');
        } else {
          console.error('‚ùå Breadcrumb element bulunamadƒ±: productName');
          // Element bulunamadƒ±ysa olu≈ütur
          const breadcrumbSection = document.querySelector('nav');
          if (breadcrumbSection) {
            const newElement = document.createElement('span');
            newElement.id = 'productName';
            newElement.className = 'text-gray-800 font-medium';
            newElement.textContent = productName;
            breadcrumbSection.appendChild(newElement);
            console.log('‚úÖ Breadcrumb element olu≈üturuldu');
          } else {
            console.error('‚ùå Breadcrumb section bulunamadƒ±: nav');
            // Alternatif olarak body'ye ekle
            const newElement = document.createElement('span');
            newElement.id = 'productName';
            newElement.className = 'text-gray-800 font-medium';
            newElement.textContent = productName;
            document.body.insertBefore(newElement, document.body.firstChild);
            console.log('‚úÖ Breadcrumb element body\'ye eklendi');
          }
        }
        
        console.log('üîç DOM durumu g√ºncellendi:', {
          productName: !!document.getElementById('productName'),
          imageProductTitle: !!document.getElementById('imageProductTitle'),
          productDescription: !!document.getElementById('productDescription'),
          productPrice: !!document.getElementById('productPrice'),
          productImage: !!document.getElementById('productImage'),
          thumbnailGallery: !!document.getElementById('thumbnailGallery')
        });
        
        // Update product info
        const imageProductTitleElement = document.getElementById('imageProductTitle');
        console.log('üîç Ba≈ülƒ±k element bulundu:', !!imageProductTitleElement);
        if (imageProductTitleElement) {
          imageProductTitleElement.textContent = productName;
          console.log('‚úÖ Ba≈ülƒ±k g√ºncellendi');
        } else {
          console.error('‚ùå Ba≈ülƒ±k element bulunamadƒ±: imageProductTitle');
          // Element bulunamadƒ±ysa olu≈ütur
          const titleSection = document.querySelector('.mb-4');
          if (titleSection) {
            const newElement = document.createElement('h1');
            newElement.id = 'imageProductTitle';
            newElement.className = 'text-2xl sm:text-3xl md:text-4xl lg:text-5xl font-display font-bold text-gray-800 leading-tight';
            newElement.textContent = productName;
            titleSection.appendChild(newElement);
            console.log('‚úÖ Ba≈ülƒ±k element olu≈üturuldu');
          } else {
            console.error('‚ùå Ba≈ülƒ±k section bulunamadƒ±: .mb-4');
            // Alternatif olarak ana √ºr√ºn b√∂l√ºm√ºn√º bul
            const productSection = document.querySelector('section.max-w-7xl');
            if (productSection) {
              const newElement = document.createElement('h1');
              newElement.id = 'imageProductTitle';
              newElement.className = 'text-2xl sm:text-3xl md:text-4xl lg:text-5xl font-display font-bold text-gray-800 leading-tight mb-4';
              newElement.textContent = productName;
              productSection.insertBefore(newElement, productSection.firstChild);
              console.log('‚úÖ Ba≈ülƒ±k element alternatif yere eklendi');
            } else {
              console.error('‚ùå Ana √ºr√ºn b√∂l√ºm√º bulunamadƒ±: section.max-w-7xl');
            }
          }
        }
        
        // Fiyat g√ºncelleme - √∂nce normal fiyatƒ± g√∂ster, sonra kampanya bilgilerini y√ºkle
        console.log('üí∞ Fiyat g√ºncelleniyor...');
        
        // Fiyat elementini bul veya olu≈ütur
        let priceElement = document.getElementById('productPrice');
        if (!priceElement) {
          console.log('üîç Fiyat element bulunamadƒ±, olu≈üturuluyor...');
          const priceSection = document.querySelector('.animate-slide-up .mb-6:first-child');
          if (priceSection) {
            priceElement = document.createElement('span');
            priceElement.id = 'productPrice';
            priceElement.className = 'text-3xl font-bold gradient-text';
            priceSection.appendChild(priceElement);
            console.log('‚úÖ Fiyat element olu≈üturuldu');
          } else {
            // Alternatif olarak body'ye ekle
            priceElement = document.createElement('span');
            priceElement.id = 'productPrice';
            priceElement.className = 'text-3xl font-bold gradient-text';
            document.body.insertBefore(priceElement, document.body.firstChild);
            console.log('‚úÖ Fiyat element body\'ye eklendi');
          }
        }
        
        // Hemen normal fiyatƒ± g√∂ster
        if (priceElement) {
          priceElement.innerHTML = `<span class="text-2xl font-bold text-gold-600">‚Ç∫${product.price}</span>`;
          console.log('‚úÖ Normal fiyat g√∂sterildi:', product.price);
          
          // Fiyatƒ±n g√∂r√ºn√ºr olduƒüundan emin ol
          priceElement.style.display = 'block';
          priceElement.style.visibility = 'visible';
          priceElement.style.opacity = '1';
        }
        
        // Kampanya bilgilerini y√ºkle ve fiyatƒ± g√ºncelle
        updateProductPriceWithCampaign(product);
        
        // √úr√ºn a√ßƒ±klamasƒ±nƒ± g√ºncelle
        const productDescriptionElement = document.getElementById('productDescription');
        console.log('üîç A√ßƒ±klama element bulundu:', !!productDescriptionElement);
        if (productDescriptionElement) {
          const description = product.description || '√úr√ºn a√ßƒ±klamasƒ± bulunamadƒ±.';
          productDescriptionElement.textContent = description;
          console.log('‚úÖ A√ßƒ±klama g√ºncellendi:', description);
        } else {
          console.error('‚ùå A√ßƒ±klama element bulunamadƒ±: productDescription');
          // Element bulunamadƒ±ysa olu≈ütur
          const descriptionSection = document.querySelector('.mb-6');
          if (descriptionSection) {
            const newElement = document.createElement('p');
            newElement.id = 'productDescription';
            newElement.className = 'text-gray-600 leading-relaxed';
            newElement.textContent = product.description || '√úr√ºn a√ßƒ±klamasƒ± bulunamadƒ±.';
            descriptionSection.appendChild(newElement);
            console.log('‚úÖ A√ßƒ±klama element olu≈üturuldu');
          } else {
            console.error('‚ùå A√ßƒ±klama section bulunamadƒ±: .mb-6');
            // Alternatif olarak ana √ºr√ºn b√∂l√ºm√ºn√º bul
            const productSection = document.querySelector('section.max-w-7xl');
            if (productSection) {
              const newElement = document.createElement('p');
              newElement.id = 'productDescription';
              newElement.className = 'text-gray-600 leading-relaxed mb-6';
              newElement.textContent = product.description || '√úr√ºn a√ßƒ±klamasƒ± bulunamadƒ±.';
              productSection.appendChild(newElement);
              console.log('‚úÖ A√ßƒ±klama element alternatif yere eklendi');
            } else {
              console.error('‚ùå Ana √ºr√ºn b√∂l√ºm√º bulunamadƒ±: section.max-w-7xl');
            }
          }
        }
        
        // G√∂rsel √∂nceliƒüi: 1) product.images 2) product.imageUrl 3) product.variants
        const productImage = document.getElementById('productImage');
        console.log('üîç √úr√ºn g√∂rsel element bulundu:', !!productImage);
        if (productImage) {
          let imageSrc = '';
          let imageAlt = productName;
          
          if (product.images && product.images.length > 0) {
            imageSrc = getImageSrc(product.images[0]);
            console.log('‚úÖ √úr√ºn g√∂rseli bulundu (images):', imageSrc);
          } else if (product.imageUrl) {
            imageSrc = product.imageUrl;
            console.log('‚úÖ √úr√ºn g√∂rseli bulundu (imageUrl):', imageSrc);
          } else if (product.variants && product.variants.length > 0) {
            const firstVariant = product.variants[0];
            if (firstVariant.images && firstVariant.images.length > 0) {
              imageSrc = getImageSrc(firstVariant.images[0]);
              imageAlt = `${productName} - ${firstVariant.color}`;
              console.log('‚úÖ √úr√ºn g√∂rseli bulundu (variant):', imageSrc);
            }
          }
          
          // Eƒüer hi√ß g√∂rsel bulunamadƒ±ysa varsayƒ±lan g√∂rsel kullan
          if (!imageSrc) {
            imageSrc = 'https://images.unsplash.com/photo-1520975922284-6c62f25a1c9b?q=80&w=800&auto=format&fit=crop';
            console.log('‚ö†Ô∏è Varsayƒ±lan g√∂rsel kullanƒ±lƒ±yor');
          }
          
          productImage.src = imageSrc;
          productImage.alt = imageAlt;
          console.log('‚úÖ √úr√ºn g√∂rseli g√ºncellendi:', imageSrc);
          
          // Thumbnail galerisini g√ºncelle
          try {
            updateThumbnailGallery(product);
            console.log('‚úÖ Thumbnail galeri g√ºncellendi');
          } catch (error) {
            console.error('‚ùå Thumbnail galeri g√ºncellenirken hata:', error);
          }
        } else {
          console.error('‚ùå √úr√ºn g√∂rsel element bulunamadƒ±: productImage');
          // Element bulunamadƒ±ysa olu≈ütur
          const imageSection = document.querySelector('.space-y-4');
          if (imageSection) {
            const newElement = document.createElement('img');
            newElement.id = 'productImage';
            newElement.className = 'w-full h-auto max-h-[80vh] object-contain product-image cursor-pointer';
            newElement.alt = '√úr√ºn G√∂rseli';
            newElement.onclick = function() { openImageModal(this.src); };
            
            let imageSrc = '';
            if (product.images && product.images.length > 0) {
              imageSrc = getImageSrc(product.images[0]);
            } else if (product.imageUrl) {
              imageSrc = product.imageUrl;
            } else {
              imageSrc = 'https://images.unsplash.com/photo-1520975922284-6c62f25a1c9b?q=80&w=800&auto=format&fit=crop';
            }
            
            newElement.src = imageSrc;
            imageSection.appendChild(newElement);
            console.log('‚úÖ √úr√ºn g√∂rsel element olu≈üturuldu');
          }
        }
        
        // Update category badge and link
        console.log('üè∑Ô∏è √úr√ºn kategori ID:', product.categoryId);
        if (product.categoryId && product.categoryId._id) {
          loadCategoryInfo(product.categoryId._id);
        } else if (product.categoryId && typeof product.categoryId === 'string') {
          loadCategoryInfo(product.categoryId);
        } else {
          console.warn('‚ö†Ô∏è √úr√ºn i√ßin ge√ßerli kategori ID bulunamadƒ±:', product);
          // Kategori badge'ini g√ºncelle
          const categoryBadge = document.getElementById('categoryBadge');
          if (categoryBadge) {
            categoryBadge.textContent = 'Genel';
          }
        }
        
        // Update size selection - varyant sistemi i√ßin
        if (product.variants && product.variants.length > 0) {
          // ƒ∞lk varyantƒ±n bedenlerini kullan
          const firstVariant = product.variants[0];
          updateSizeSelectionForVariant(firstVariant);
        } else {
          // Eski sistem i√ßin geriye d√∂n√ºk uyumluluk
          updateSizeSelection(product.sizeStocks || []);
        }
        
        // Legacy renk render'ƒ±nƒ± devre dƒ±≈üƒ± bƒ±raktƒ±k; yeni varyant sisteme ge√ßildi

        // Update WhatsApp order button
        updateWhatsAppButton(product);
        
        // Update WhatsApp float button
          updateWhatsAppFloatButton();

          // URL'den gelen se√ßimleri uygula (√∂r. ?variant=1 veya ?color=kirmizi)
          applySelectionFromUrl(product);
      }

      // Kampanya indirim bilgilerini hesapla ve fiyatƒ± g√ºncelle
      async function updateProductPriceWithCampaign(product) {
        try {
          console.log('üí∞ updateProductPriceWithCampaign √ßaƒürƒ±ldƒ±, √ºr√ºn:', {
            id: product._id,
            name: product.name,
            price: product.price
          });
          
          // √ñnce fiyat elementini bul veya olu≈ütur
          let priceElement = document.getElementById('productPrice');
          if (!priceElement) {
            console.log('üîç Fiyat element bulunamadƒ±, olu≈üturuluyor...');
            // Daha spesifik selector kullan - fiyat b√∂l√ºm√ºn√º bul
            const priceSection = document.querySelector('#productPrice').parentElement || 
                               document.querySelector('.animate-slide-up .mb-6:first-child') ||
                               document.querySelector('.animate-slide-up div:first-child');
            if (priceSection) {
              priceElement = document.createElement('span');
              priceElement.id = 'productPrice';
              priceElement.className = 'text-3xl font-bold gradient-text';
              priceSection.appendChild(priceElement);
              console.log('‚úÖ Fiyat element olu≈üturuldu');
            } else {
              console.error('‚ùå Fiyat section bulunamadƒ±');
              // Alternatif olarak body'ye ekle
              priceElement = document.createElement('span');
              priceElement.id = 'productPrice';
              priceElement.className = 'text-3xl font-bold gradient-text';
              document.body.insertBefore(priceElement, document.body.firstChild);
              console.log('‚úÖ Fiyat element body\'ye eklendi');
            }
          }
          
          // √ñnce normal fiyatƒ± g√∂ster (kampanya y√ºklenene kadar)
          if (priceElement) {
            priceElement.innerHTML = `<span class="text-2xl font-bold text-gold-600">‚Ç∫${product.price}</span>`;
            priceElement.style.display = 'block';
            priceElement.style.visibility = 'visible';
            priceElement.style.opacity = '1';
            console.log('‚úÖ Ge√ßici fiyat g√∂sterildi:', product.price);
          }
          
          // Kampanya verilerini y√ºkle
          const campaigns = await fetch('/api/campaigns');
          const campaignsData = await campaigns.json();
          
          let campaignDiscount = 0;
          let discountedPrice = product.price;
          let originalPrice = product.price;
          
          // Aktif kampanyalardan bu √ºr√ºn i√ßin en y√ºksek indirimi bul
          campaignsData.forEach(campaign => {
            if (campaign.isActive && campaign.discount > 0) {
              // √úr√ºn bazlƒ± kampanya kontrol√º
              if (campaign.type === 'products' && campaign.productIds && campaign.productIds.some(p => p._id === product._id)) {
                if (campaign.discount > campaignDiscount) {
                  campaignDiscount = campaign.discount;
                }
              }
              // Kategori bazlƒ± kampanya kontrol√º
              else if (campaign.type === 'category' && campaign.targetId && product.categoryId && product.categoryId._id === campaign.targetId._id) {
                if (campaign.discount > campaignDiscount) {
                  campaignDiscount = campaign.discount;
                }
              }
            }
          });
          
          // ƒ∞ndirimli fiyatƒ± hesapla ve g√∂ster
          if (campaignDiscount > 0) {
            discountedPrice = Math.round(product.price * (1 - campaignDiscount / 100));
            originalPrice = product.price;
            
            const priceHtml = `
              <div class="flex flex-col items-start gap-1">
                <div class="text-2xl font-bold text-red-600">‚Ç∫${discountedPrice}</div>
                <div class="text-lg text-gray-500 line-through">‚Ç∫${originalPrice}</div>
                <div class="text-sm font-medium text-red-500 bg-red-100 px-2 py-1 rounded-full">%${campaignDiscount} ƒ∞ndirim</div>
              </div>
            `;
            priceElement.innerHTML = priceHtml;
            priceElement.style.display = 'block';
            priceElement.style.visibility = 'visible';
            priceElement.style.opacity = '1';
            console.log('‚úÖ ƒ∞ndirimli fiyat g√ºncellendi:', { discountedPrice, originalPrice, campaignDiscount });
          } else {
            // Kampanya yoksa normal fiyatƒ± g√∂ster
            const priceHtml = `<span class="text-2xl font-bold text-gold-600">‚Ç∫${product.price}</span>`;
            priceElement.innerHTML = priceHtml;
            priceElement.style.display = 'block';
            priceElement.style.visibility = 'visible';
            priceElement.style.opacity = '1';
            console.log('‚úÖ Normal fiyat g√ºncellendi:', product.price);
          }
          
        } catch (error) {
          console.error('Kampanya bilgileri y√ºklenirken hata:', error);
          // Hata durumunda normal fiyatƒ± g√∂ster
          let priceElement = document.getElementById('productPrice');
          if (!priceElement) {
            const priceSection = document.querySelector('#productPrice').parentElement || 
                               document.querySelector('.animate-slide-up .mb-6:first-child') ||
                               document.querySelector('.animate-slide-up div:first-child');
            if (priceSection) {
              priceElement = document.createElement('span');
              priceElement.id = 'productPrice';
              priceElement.className = 'text-3xl font-bold gradient-text';
              priceSection.appendChild(priceElement);
            } else {
              // Son √ßare olarak body'ye ekle
              priceElement = document.createElement('span');
              priceElement.id = 'productPrice';
              priceElement.className = 'text-3xl font-bold gradient-text';
              document.body.insertBefore(priceElement, document.body.firstChild);
            }
          }
          
          if (priceElement) {
            const priceHtml = `<span class="text-2xl font-bold text-gold-600">‚Ç∫${product.price}</span>`;
            priceElement.innerHTML = priceHtml;
            priceElement.style.display = 'block';
            priceElement.style.visibility = 'visible';
            priceElement.style.opacity = '1';
            console.log('‚úÖ Hata durumunda normal fiyat g√∂sterildi:', product.price);
          }
        }
      }

      // Benzer √ºr√ºnler i√ßin kampanya fiyatƒ±nƒ± hesapla (senkron)
      function getProductPriceWithCampaign(product) {
        // Global kampanya verilerini kullan (eƒüer y√ºklendiyse)
        if (window.activeCampaigns && Array.isArray(window.activeCampaigns)) {
          let campaignDiscount = 0;
          
          // Aktif kampanyalardan bu √ºr√ºn i√ßin en y√ºksek indirimi bul
          window.activeCampaigns.forEach(campaign => {
            if (campaign.isActive && campaign.discount > 0) {
              // √úr√ºn bazlƒ± kampanya kontrol√º
              if (campaign.type === 'products' && campaign.productIds && campaign.productIds.some(p => p._id === product._id)) {
                if (campaign.discount > campaignDiscount) {
                  campaignDiscount = campaign.discount;
                }
              }
              // Kategori bazlƒ± kampanya kontrol√º
              else if (campaign.type === 'category' && campaign.targetId && product.categoryId && product.categoryId._id === campaign.targetId._id) {
                if (campaign.discount > campaignDiscount) {
                  campaignDiscount = campaign.discount;
                }
              }
            }
          });
          
          // ƒ∞ndirimli fiyatƒ± hesapla
          if (campaignDiscount > 0) {
            const discountedPrice = Math.round(product.price * (1 - campaignDiscount / 100));
            return `
              <span class="text-lg font-bold text-red-600">‚Ç∫${discountedPrice}</span>
              <span class="text-sm text-gray-500 line-through">‚Ç∫${product.price}</span>
              <span class="text-xs text-red-500 bg-red-100 px-1 py-0.5 rounded-full">%${campaignDiscount}</span>
            `;
          }
        }
        
        // Kampanya yoksa normal fiyatƒ± g√∂ster
        return `<span class="text-lg font-bold text-gold-600">‚Ç∫${product.price}</span>`;
      }

      async function loadCategoryInfo(categoryId) {
        try {
          console.log('Loading category info for ID:', categoryId);
          const response = await fetch(`/api/categories/${categoryId}`);
          const category = await response.json();
          
          console.log('Category response:', response.status, category);
          
          if (response.ok) {
            document.getElementById('categoryBadge').textContent = category.name;
            document.getElementById('categoryLink').textContent = category.name;
            document.getElementById('categoryLink').href = `/category.html?id=${categoryId}`;
            document.getElementById('backToCategoryBtn').href = `/category.html?id=${categoryId}`;
            
            // Update product specifications
            document.getElementById('productCategory').textContent = category.name;
            console.log('Category info updated successfully');
          } else {
            console.error('Category API error:', category.message);
          }
        } catch (error) {
          console.error('Kategori bilgisi y√ºklenemedi:', error);
        }
      }

      // Varyant i√ßin beden se√ßimi g√ºncelle
      function updateSizeSelectionForVariant(variant) {
        const sizeContainer = document.getElementById('sizeContainer');
        sizeContainer.innerHTML = '';
        
        if (!variant.sizes || variant.sizes.length === 0) {
          sizeContainer.innerHTML = '<p class="text-gray-500">Beden bilgisi bulunmuyor.</p>';
          return;
        }
        
        variant.sizes.forEach(size => {
          const sizeBadge = document.createElement('div');
          sizeBadge.className = `size-badge px-4 py-2 rounded-lg border-2 cursor-pointer ${
            variant.stock > 0 
              ? 'border-gold-400 bg-gold-50 text-gold-700 hover:bg-gold-100' 
              : 'border-gray-300 bg-gray-100 text-gray-400 cursor-not-allowed'
          }`;
          sizeBadge.textContent = size;
          
          if (variant.stock > 0) {
            sizeBadge.addEventListener('click', () => selectSize(size));
          }
          
          sizeContainer.appendChild(sizeBadge);
        });
      }

      // Eski sistem i√ßin beden se√ßimi (geriye d√∂n√ºk uyumluluk)
      function updateSizeSelection(sizeStocks) {
        const sizeContainer = document.getElementById('sizeContainer');
        sizeContainer.innerHTML = '';
        
        if (sizeStocks.length === 0) {
          sizeContainer.innerHTML = '<p class="text-gray-500">Beden bilgisi bulunmuyor.</p>';
          return;
        }
        
        sizeStocks.forEach(sizeStock => {
          const sizeBadge = document.createElement('div');
          sizeBadge.className = `size-badge px-4 py-2 rounded-lg border-2 cursor-pointer ${
            sizeStock.stock > 0 
              ? 'border-gold-400 bg-gold-50 text-gold-700 hover:bg-gold-100' 
              : 'border-gray-300 bg-gray-100 text-gray-400 cursor-not-allowed'
          }`;
          sizeBadge.textContent = `${sizeStock.size} (${sizeStock.stock > 0 ? sizeStock.stock + ' adet' : 'Stok yok'})`;
          
          if (sizeStock.stock > 0) {
            sizeBadge.addEventListener('click', () => selectSize(sizeStock.size));
          }
          
          sizeContainer.appendChild(sizeBadge);
        });
      }

      function selectSize(size) {
        // Remove previous selection
        document.querySelectorAll('.size-badge').forEach(badge => {
          badge.classList.remove('border-gold-600', 'bg-gold-100');
          badge.classList.add('border-gold-400', 'bg-gold-50');
        });
        
        // Add selection to clicked size
        event.target.classList.remove('border-gold-400', 'bg-gold-50');
        event.target.classList.add('border-gold-600', 'bg-gold-100');
        
        // Varyant sistemi i√ßin se√ßili bedeni kaydet
        if (selectedColor && selectedColor.variantIndex !== undefined) {
          selectedColor.selectedSize = size;
          console.log('Selected size for variant:', size);
        }
      }

      function updateWhatsAppButton(product) {
        const whatsappBtn = document.getElementById('whatsappOrderBtn');
        const productName = product.productName || product.name;
        
        // Kampanya indirim bilgilerini hesapla
        let priceText = `‚Ç∫${product.price}`;
        let discountText = '';
        
        if (window.activeCampaigns && Array.isArray(window.activeCampaigns)) {
          let campaignDiscount = 0;
          
          // Aktif kampanyalardan bu √ºr√ºn i√ßin en y√ºksek indirimi bul
          window.activeCampaigns.forEach(campaign => {
            if (campaign.isActive && campaign.discount > 0) {
              // √úr√ºn bazlƒ± kampanya kontrol√º
              if (campaign.type === 'products' && campaign.productIds && campaign.productIds.some(p => p._id === product._id)) {
                if (campaign.discount > campaignDiscount) {
                  campaignDiscount = campaign.discount;
                }
              }
              // Kategori bazlƒ± kampanya kontrol√º
              else if (campaign.type === 'category' && campaign.targetId && product.categoryId && product.categoryId._id === campaign.targetId._id) {
                if (campaign.discount > campaignDiscount) {
                  campaignDiscount = campaign.discount;
                }
              }
            }
          });
          
          // ƒ∞ndirimli fiyatƒ± hesapla
          if (campaignDiscount > 0) {
            const discountedPrice = Math.round(product.price * (1 - campaignDiscount / 100));
            priceText = `‚Ç∫${discountedPrice}`;
            discountText = ` (%${campaignDiscount} indirimli, normal fiyat: ‚Ç∫${product.price})`;
          }
        }
        
        const message = `Merhaba! ${productName} √ºr√ºn√º hakkƒ±nda bilgi almak istiyorum. Fiyat: ${priceText}${discountText}`;
        const num = (window.APP_CONFIG && window.APP_CONFIG.WHATSAPP_NUMBER) ? window.APP_CONFIG.WHATSAPP_NUMBER : '905065668854';
        const whatsappUrl = `https://wa.me/${num}?text=${encodeURIComponent(message)}`;
        whatsappBtn.href = whatsappUrl;
        
        // Load similar products
        const categoryId = product.categoryId && product.categoryId._id ? product.categoryId._id : product.categoryId;
        loadSimilarProducts(categoryId, product._id);
      }

      function updateWhatsAppFloatButton() {
        const floatBtn = document.getElementById('whatsappFloatBtn');
        if (floatBtn) {
          const num = (window.APP_CONFIG && window.APP_CONFIG.WHATSAPP_NUMBER) ? window.APP_CONFIG.WHATSAPP_NUMBER : '905065668854';
          floatBtn.href = `https://wa.me/${num}`;
        }
      }

      async function loadSimilarProducts(categoryId, currentProductId) {
        try {
          const response = await fetch(`/api/products?categoryId=${categoryId}`);
          const products = await response.json();
          
          if (response.ok && products.length > 0) {
            // Filter out current product and limit to 4
            const similarProducts = products
              .filter(p => p._id !== currentProductId)
              .slice(0, 4);
            
            displaySimilarProducts(similarProducts);
          }
        } catch (error) {
          console.error('Benzer √ºr√ºnler y√ºklenemedi:', error);
        }
      }

      function displaySimilarProducts(products) {
        const grid = document.getElementById('similarProductsGrid');
        
        if (products.length === 0) {
          grid.innerHTML = '<p class="text-gray-500 text-center col-span-full">Bu kategoride ba≈üka √ºr√ºn bulunmuyor.</p>';
          return;
        }
        
        grid.innerHTML = products.map(product => {
          const productName = product.productName || product.name;
          const productImage = product.variants && product.variants.length > 0 
            ? (product.variants[0].images && product.variants[0].images.length > 0 ? product.variants[0].images[0] : null)
            : product.imageUrl;
          
          return `
            <div class="group bg-white rounded-2xl shadow-lg hover:shadow-xl transition-all duration-300 overflow-hidden cursor-pointer" onclick="window.location.href='/product/${product._id}'">
              <div class="aspect-[4/3] overflow-hidden">
                <img src="${productImage || 'https://images.unsplash.com/photo-1520975922284-6c62f25a1c9b?q=80&w=800&auto=format&fit=crop'}" 
                     alt="${productName}" 
                     class="w-full h-full object-contain group-hover:scale-110 transition-transform duration-500" />
              </div>
              <div class="p-4">
                <h3 class="font-semibold text-gray-800 mb-2 group-hover:text-gold-600 transition-colors duration-300 line-clamp-2">
                  ${productName}
                </h3>
                <div class="flex items-center justify-between">
                  <div class="flex flex-col items-start">
                    ${getProductPriceWithCampaign(product)}
                  </div>
                  <span class="text-sm text-gray-500">Detaylar ‚Üí</span>
                </div>
              </div>
            </div>
          `;
        }).join('');
      }

      // Thumbnail Gallery Functions - √áoklu g√∂rsel desteƒüi
      function updateThumbnailGallery(product) {
        console.log('üñºÔ∏è updateThumbnailGallery √ßaƒürƒ±ldƒ±, √ºr√ºn:', product);
        
        const thumbnailGallery = document.getElementById('thumbnailGallery');
        console.log('üîç Thumbnail galeri element bulundu:', !!thumbnailGallery);
        
        if (!thumbnailGallery) {
          console.error('‚ùå Thumbnail galeri element bulunamadƒ±: thumbnailGallery');
          return;
        }
        
        let thumbnails = [];
        
        // √ñncelik: √ºr√ºn√ºn kendi g√∂rselleri > tek g√∂rsel > varyant g√∂rselleri
        if (product.images && product.images.length > 0) {
          console.log('üì∏ √úr√ºn g√∂rselleri bulundu:', product.images.length);
          thumbnails = product.images.map((img, index) => {
            const src = getImageSrc(img);
            const isObj = typeof img === 'object' && img !== null;
            return {
              src,
              alt: (isObj && img.name) ? img.name : `G√∂rsel ${index + 1}`,
              isMain: (isObj && 'isMain' in img) ? !!img.isMain : index === 0
            };
          });
        } else if (product.imageUrl) {
          console.log('üì∏ √úr√ºn tek g√∂rseli bulundu:', product.imageUrl);
          thumbnails = [
            { src: product.imageUrl, alt: 'Ana G√∂rsel', isMain: true }
          ];
        } else if (product.variants && product.variants.length > 0) {
          console.log('üé® Varyant g√∂rselleri bulundu:', product.variants.length);
          const firstVariant = product.variants[0];
          if (firstVariant.images && firstVariant.images.length > 0) {
            thumbnails = firstVariant.images.map((img, index) => ({
              src: getImageSrc(img),
              alt: `${firstVariant.color} renk g√∂rseli ${index + 1}`,
              isMain: index === 0
            }));
          }
        }
        
        // Eƒüer hi√ß g√∂rsel yoksa varsayƒ±lan g√∂rsel
        if (thumbnails.length === 0) {
          console.log('‚ö†Ô∏è Hi√ß g√∂rsel bulunamadƒ±, varsayƒ±lan g√∂rsel kullanƒ±lƒ±yor');
          thumbnails = [
            { src: 'https://images.unsplash.com/photo-1520975922284-6c62f25a1c9b?q=80&w=800&auto=format&fit=crop', alt: 'Varsayƒ±lan G√∂rsel', isMain: true }
          ];
        }
        
        console.log('üñºÔ∏è Toplam thumbnail sayƒ±sƒ±:', thumbnails.length);
        
        // Global allImages dizisini g√ºncelle
        allImages = thumbnails.map(thumb => thumb.src);
        currentImageIndex = 0;
        
        try {
          thumbnailGallery.innerHTML = thumbnails.map((thumb, index) => `
            <div class="aspect-square overflow-hidden rounded-lg border-2 ${thumb.isMain ? 'border-gold-400' : 'border-transparent'} hover:border-gold-400 transition-all duration-300 cursor-pointer group relative" 
                 onclick="goToImage(${index})">
              <img src="${thumb.src}" 
                   alt="${thumb.alt}" 
                   class="w-full h-full object-contain group-hover:scale-110 transition-transform duration-300" />
              <div class="absolute inset-0 bg-gold-400/20 opacity-0 group-hover:opacity-100 transition-opacity duration-300"></div>
              ${thumb.isMain ? '<div class="absolute top-2 left-2 bg-gold-400 text-white text-xs px-2 py-1 rounded-full">Ana</div>' : ''}
            </div>
          `).join('');
          
          console.log('‚úÖ Thumbnail HTML olu≈üturuldu');
          
          // ƒ∞lk g√∂rseli ana g√∂rsel olarak ayarla ve galeri durumunu g√ºncelle
          if (thumbnails.length > 0) {
            updateMainImageDisplay();
            updateImageCounter();
            updateImageDots();
            updateNavigationButtons();
            console.log('‚úÖ Galeri durumu g√ºncellendi');
          }
        } catch (error) {
          console.error('‚ùå Thumbnail HTML olu≈üturulurken hata:', error);
        }
      }

      function updateMainImage(imageSrc, thumbnailElement, index) {
        // Ana g√∂rseli g√ºncelle
        const mainImage = document.getElementById('productImage');
        mainImage.src = imageSrc;
        
        // thumbnailElement yoksa (√∂r. null) se√ßim/g√∂rsel etiket g√ºncellemesini atla
        if (!thumbnailElement) return;
        
        // Thumbnail se√ßimini g√ºncelle
        document.querySelectorAll('#thumbnailGallery > div').forEach(thumb => {
          thumb.classList.remove('border-gold-400');
          thumb.classList.add('border-transparent');
          const mainLabel = thumb.querySelector('.absolute.top-2.left-2');
          if (mainLabel) mainLabel.remove();
        });
        
        thumbnailElement.classList.remove('border-transparent');
        thumbnailElement.classList.add('border-gold-400');
        
        // Ana g√∂rsel etiketini ekle
        if (!thumbnailElement.querySelector('.absolute.top-2.left-2')) {
          const mainLabel = document.createElement('div');
          mainLabel.className = 'absolute top-2 left-2 bg-gold-400 text-white text-xs px-2 py-1 rounded-full';
          mainLabel.textContent = 'Ana';
          thumbnailElement.appendChild(mainLabel);
        }
      }

      // Image Modal Functions
      function openImageModal(imageSrc) {
        const modal = document.getElementById('imageModal');
        const modalImage = document.getElementById('modalImage');
        modalImage.src = imageSrc;
        modal.classList.remove('hidden');
        modal.classList.add('flex');
        document.body.style.overflow = 'hidden';
      }
      
      // Klavye ile resim deƒüi≈ütirme
      document.addEventListener('keydown', function(e) {
        if (allImages.length > 1) {
          if (e.key === 'ArrowLeft') {
            previousImage();
          } else if (e.key === 'ArrowRight') {
            nextImage();
          }
        }
      });

      function closeImageModal() {
        const modal = document.getElementById('imageModal');
        modal.classList.add('hidden');
        modal.classList.remove('flex');
        document.body.style.overflow = 'auto';
      }

      // Close modal on background click
      document.getElementById('imageModal')?.addEventListener('click', (e) => {
        if (e.target.id === 'imageModal') {
          closeImageModal();
        }
      });

      // Close modal on ESC key
      document.addEventListener('keydown', (e) => {
        if (e.key === 'Escape') {
          closeImageModal();
        }
      });

      // Social Media Share Functions
      function shareOnFacebook() {
        const url = encodeURIComponent(window.location.href);
        const text = encodeURIComponent(document.title);
        const facebookUrl = `https://www.facebook.com/sharer/sharer.php?u=${url}`;
        window.open(facebookUrl, '_blank', 'width=600,height=400');
      }

      function shareOnWhatsApp() {
        const url = encodeURIComponent(window.location.href);
        const text = encodeURIComponent(document.title);
        const whatsappUrl = `https://wa.me/?text=${text}%20${url}`;
        window.open(whatsappUrl, '_blank');
      }
      
      // Image Gallery Navigation Functions
      function previousImage() {
        if (allImages.length > 1) {
          currentImageIndex = (currentImageIndex - 1 + allImages.length) % allImages.length;
          updateMainImageDisplay();
          updateImageCounter();
          updateImageDots();
        }
      }
      
      function nextImage() {
        if (allImages.length > 1) {
          currentImageIndex = (currentImageIndex + 1) % allImages.length;
          updateMainImageDisplay();
          updateImageCounter();
          updateImageDots();
        }
      }
      
      function goToImage(index) {
        if (index >= 0 && index < allImages.length) {
          currentImageIndex = index;
          updateMainImageDisplay();
          updateImageCounter();
          updateImageDots();
        }
      }
      
      function updateMainImageDisplay() {
        console.log('üñºÔ∏è updateMainImageDisplay √ßaƒürƒ±ldƒ±, allImages:', allImages);
        
        if (allImages.length > 0) {
          const mainImage = document.getElementById('productImage');
          console.log('üîç Ana g√∂rsel element bulundu:', !!mainImage);
          
          if (mainImage) {
            const currentImage = allImages[currentImageIndex];
            const imageSrc = typeof currentImage === 'string' ? currentImage : (currentImage.url || currentImage);
            
            console.log('üñºÔ∏è G√ºncellenecek g√∂rsel:', imageSrc);
            
            if (imageSrc) {
              mainImage.src = imageSrc;
              mainImage.alt = `√úr√ºn G√∂rseli ${currentImageIndex + 1}`;
              console.log('‚úÖ Ana g√∂rsel g√ºncellendi:', imageSrc);
            } else {
              console.error('‚ùå G√∂rsel kaynaƒüƒ± bulunamadƒ±');
            }
          } else {
            console.error('‚ùå Ana g√∂rsel element bulunamadƒ±: productImage');
          }
        } else {
          console.warn('‚ö†Ô∏è G√ºncellenecek g√∂rsel yok: allImages bo≈ü');
        }
      }
      
      function updateImageCounter() {
        const counter = document.getElementById('imageCounter');
        if (counter) {
          counter.textContent = `${currentImageIndex + 1} / ${allImages.length}`;
        }
      }
      
      function updateImageDots() {
        const dotsContainer = document.getElementById('imageDots');
        if (dotsContainer && allImages.length > 1) {
          dotsContainer.innerHTML = '';
          
          for (let i = 0; i < allImages.length; i++) {
            const dot = document.createElement('div');
            dot.className = `image-dot w-3 h-3 rounded-full cursor-pointer ${
              i === currentImageIndex 
                ? 'active bg-white' 
                : 'bg-white/50 hover:bg-white/75'
            }`;
            dot.onclick = () => goToImage(i);
            dotsContainer.appendChild(dot);
          }
        }
      }
      
      function updateNavigationButtons() {
        const prevBtn = document.getElementById('prevImageBtn');
        const nextBtn = document.getElementById('nextImageBtn');
        
        if (prevBtn && nextBtn) {
          if (allImages.length <= 1) {
            prevBtn.style.display = 'none';
            nextBtn.style.display = 'none';
          } else {
            prevBtn.style.display = 'flex';
            nextBtn.style.display = 'flex';
          }
        }
      }

      // FAQ Functions
      function toggleFAQ(button) {
        const faqItem = button.closest('.bg-white');
        const content = faqItem.querySelector('div:last-child');
        const arrow = button.querySelector('svg');
        
        // Toggle content visibility
        if (content.classList.contains('hidden')) {
          content.classList.remove('hidden');
          arrow.style.transform = 'rotate(180deg)';
        } else {
          content.classList.add('hidden');
          arrow.style.transform = 'rotate(0deg)';
        }
      }

      // Image Gallery Functions
      let currentImageIndex = 0;
      let allImages = [];
      
      // Color Variant Functions
      let selectedColor = null;
      let currentProduct = null;

      function displayLegacyColorVariants(product) {
        console.log('displayLegacyColorVariants called with product:', product);
        console.log('Product variants:', product.variants);
        
        currentProduct = product;
        const colorSection = document.getElementById('colorVariantsSection');
        const colorContainer = document.getElementById('colorVariantsContainer');
        const selectedColorName = document.getElementById('selectedColorName');
        
        console.log('Color section element:', colorSection);
        console.log('Color container element:', colorContainer);
        
        // Her durumda renk se√ßimi kƒ±smƒ±nƒ± g√∂ster
        colorSection.classList.remove('hidden');
        colorSection.style.display = 'block';
        colorSection.style.visibility = 'visible';
        colorContainer.innerHTML = '';
        
        let allColors = [];
        
        // Ana rengi ekle (mainColor ve mainColorHex varsa)
        if (product.mainColor && product.mainColorHex) {
          allColors.push({
            name: product.mainColor,
            hexCode: product.mainColorHex,
            imageUrl: product.imageUrl || (product.images && product.images.length > 0 ? product.images[0].url : ''),
            isMain: true,
            index: -1 // Ana renk i√ßin √∂zel index
          });
        }
        
        // Yeni varyant sistemi kontrol√º
        if (product.variants && product.variants.length > 0) {
          console.log('Variants found, adding to colors');
          
          product.variants.forEach((variant, index) => {
            console.log('Processing variant:', variant);
            // Ana renkle aynƒ± renk varsa ekleme
            const isDuplicate = allColors.some(color => 
              color.name.toLowerCase() === variant.color.toLowerCase()
            );
            
            if (!isDuplicate) {
              allColors.push({
                name: variant.color,
                hexCode: getColorHex(variant.color),
                imageUrl: variant.images && variant.images.length > 0 ? variant.images[0] : '',
                isMain: false,
                index: index
              });
            }
          });
        } else if (product.colorVariants && product.colorVariants.length > 0) {
          // Eski sistem i√ßin geriye d√∂n√ºk uyumluluk
          console.log('Old colorVariants found, adding to colors');
          
          product.colorVariants.forEach((colorVariant, index) => {
            console.log('Processing old color variant:', colorVariant);
            if (colorVariant.isActive) {
              // Ana renkle aynƒ± renk varsa ekleme
              const isDuplicate = allColors.some(color => 
                color.name.toLowerCase() === colorVariant.name.toLowerCase()
              );
              
              if (!isDuplicate) {
                allColors.push({
                  name: colorVariant.name,
                  hexCode: colorVariant.hexCode,
                  imageUrl: colorVariant.imageUrl || '',
                  isMain: false,
                  index: index
                });
              }
            }
          });
        }
        
        // T√ºm renkleri g√∂ster
        allColors.forEach((color, displayIndex) => {
          const colorCircle = document.createElement('div');
          colorCircle.className = 'relative group cursor-pointer';
          colorCircle.setAttribute('aria-label', `${color.name} rengi se√ß`);
          
          const mainBadge = '';
          
          colorCircle.innerHTML = `
            <div class="w-12 h-12 rounded-full border-4 border-white shadow-lg hover:shadow-xl transition-all duration-300 hover:scale-110"
                 style="background-color: ${color.hexCode};"
                 onclick="selectColor('${color.name}', '${color.hexCode}', '${color.imageUrl}', this, ${color.index})">
            </div>
            ${mainBadge}
            <div class="absolute -bottom-8 left-1/2 transform -translate-x-1/2 bg-gray-800 text-white text-xs px-2 py-1 rounded whitespace-nowrap opacity-0 group-hover:opacity-100 transition-opacity duration-200 pointer-events-none">
              ${color.name}
            </div>
          `;
          
          colorContainer.appendChild(colorCircle);
        });
        
        // ƒ∞lk rengi (ana renk varsa onu, yoksa ilk varyantƒ±) varsayƒ±lan olarak se√ß
        if (allColors.length > 0) {
          const firstColor = allColors[0];
          selectColor(firstColor.name, firstColor.hexCode, firstColor.imageUrl, colorContainer.firstElementChild, firstColor.index);
        }
      }

      // Renk adƒ±ndan hex kodu √ºret
      function getColorHex(colorName) {
        const colorMap = {
          'kƒ±rmƒ±zƒ±': '#FF0000',
          'kirmizi': '#FF0000',
          'mavi': '#0000FF',
          'ye≈üil': '#00FF00',
          'yesil': '#00FF00',
          'sarƒ±': '#FFFF00',
          'sari': '#FFFF00',
          'mor': '#800080',
          'turuncu': '#FFA500',
          'pembe': '#FFC0CB',
          'kahverengi': '#A52A2A',
          'siyah': '#000000',
          'beyaz': '#FFFFFF',
          'gri': '#808080',
          'altƒ±n': '#FFD700',
          'altin': '#FFD700',
          'g√ºm√º≈ü': '#C0C0C0',
          'gumus': '#C0C0C0',
          'krem': '#F5F5DC',
          'bej': '#F5F5DC',
          'lacivert': '#000080',
          'bordo': '#800020',
          'haki': '#8B7355'
        };
        
        return colorMap[colorName.toLowerCase()] || '#808080';
      }

      function selectColor(colorName, hexCode, imageUrl, colorElement, variantIndex) {
        console.log('selectColor called with:', { colorName, hexCode, imageUrl, variantIndex });
        console.log('currentProduct:', currentProduct);
        
        selectedColor = { 
          name: colorName, 
          hexCode: hexCode, 
          imageUrl: imageUrl,
          variantIndex: variantIndex 
        };
        
        // Update selected color display
        document.getElementById('selectedColorName').textContent = colorName;
        
        // Update color selection visual
        document.querySelectorAll('#colorVariantsContainer > div').forEach(circle => {
          circle.querySelector('div').classList.remove('ring-4', 'ring-blue-500');
        });
        colorElement.querySelector('div').classList.add('ring-4', 'ring-blue-500');
        
        // Ana renk mi yoksa varyant mƒ± kontrol et
        if (variantIndex === -1) {
          console.log('Ana renk se√ßildi, updateToMainProduct √ßaƒüƒ±rƒ±lƒ±yor');
          // Ana renk se√ßildi - ana √ºr√ºn bilgilerini g√∂ster
          updateToMainProduct();
        } else if (variantIndex !== undefined && variantIndex !== null) {
          console.log('Varyant se√ßildi, index:', variantIndex);
          // Varyant se√ßildi - o varyanta ait bilgileri g√∂ster
          updateToVariantProduct(variantIndex);
        } else {
          console.log('Basit renk deƒüi≈üimi, sadece g√∂rsel g√ºncelleniyor');
          // Basit renk deƒüi≈üimi - sadece g√∂rsel g√ºncelle
          if (imageUrl && imageUrl.trim() !== '') {
            const mainImage = document.getElementById('productImage');
            mainImage.src = imageUrl;
            console.log('G√∂rsel g√ºncellendi:', imageUrl);
          }
        }
        
        // Update URL with selected color
        const url = new URL(window.location);
        url.searchParams.set('color', colorName.toLowerCase());
        window.history.replaceState({}, '', url);
        
        console.log('Selected color:', selectedColor);
      }
      
      // Ana √ºr√ºn bilgilerini g√∂ster
      function updateToMainProduct() {
        console.log('updateToMainProduct √ßaƒüƒ±rƒ±ldƒ±');
        if (!currentProduct) {
          console.log('currentProduct bulunamadƒ±');
          return;
        }
        
        // Ana √ºr√ºn g√∂rselini g√ºncelle
        const mainImage = document.getElementById('productImage');
        if (currentProduct.imageUrl) {
          console.log('Ana √ºr√ºn g√∂rseli g√ºncelleniyor:', currentProduct.imageUrl);
          mainImage.src = currentProduct.imageUrl;
        } else if (currentProduct.images && currentProduct.images.length > 0) {
          const firstSrc = getImageSrc(currentProduct.images[0]);
          console.log('Ana √ºr√ºn √ßoklu g√∂rsel g√ºncelleniyor:', firstSrc);
          mainImage.src = firstSrc;
        } else {
          console.log('Ana √ºr√ºn i√ßin g√∂rsel bulunamadƒ±');
        }
        
        // Ana √ºr√ºn thumbnail gallery g√ºncelle
        console.log('Thumbnail gallery g√ºncelleniyor');
        updateThumbnailGallery(currentProduct);
        
        // Ana √ºr√ºn beden ve stok bilgilerini g√ºncelle
        if (currentProduct.sizeStocks) {
          console.log('Ana √ºr√ºn beden bilgileri g√ºncelleniyor:', currentProduct.sizeStocks);
          updateSizeSelection(currentProduct.sizeStocks);
        } else {
          console.log('Ana √ºr√ºn i√ßin beden bilgisi yok');
          const sizeContainer = document.getElementById('sizeContainer');
          sizeContainer.innerHTML = '<p class="text-gray-500">Beden bilgisi bulunmuyor.</p>';
        }
        
        // Stok durumunu g√ºncelle
        updateStockDisplay();
      }
      
      // Varyant √ºr√ºn bilgilerini g√∂ster
      function updateToVariantProduct(variantIndex) {
        console.log('updateToVariantProduct √ßaƒüƒ±rƒ±ldƒ±, variantIndex:', variantIndex);
        if (!currentProduct || variantIndex === undefined) {
          console.log('currentProduct veya variantIndex eksik');
          return;
        }
        
        let variant = null;
        
        // Yeni varyant sistemi
        if (currentProduct.variants && currentProduct.variants[variantIndex]) {
          variant = currentProduct.variants[variantIndex];
          console.log('Yeni varyant sistemi, variant:', variant);
          
          // Varyant g√∂rselini g√ºncelle
          const mainImage = document.getElementById('productImage');
          if (variant.images && variant.images.length > 0) {
            const first = getImageSrc(variant.images[0]);
            console.log('Varyant g√∂rseli g√ºncelleniyor:', first);
            mainImage.src = first;
          }
          
          // Varyant thumbnail gallery g√ºncelle
          updateThumbnailGalleryForVariant(variant);
          
          // Varyant beden ve stok bilgilerini g√ºncelle
          updateSizesAndStockForVariant(variant);
          
        } else if (currentProduct.colorVariants && currentProduct.colorVariants[variantIndex]) {
          // Eski sistem
          const colorVariant = currentProduct.colorVariants[variantIndex];
          console.log('Eski sistem, colorVariant:', colorVariant);
          
          // Renk varyantƒ± g√∂rselini g√ºncelle
          const mainImage = document.getElementById('productImage');
          if (colorVariant.imageUrl) {
            console.log('Eski sistem g√∂rseli g√ºncelleniyor:', colorVariant.imageUrl);
            mainImage.src = colorVariant.imageUrl;
          }
          
          // Eski sistem i√ßin beden bilgileri (ana √ºr√ºn√ºn sizeStocks'unu kullan)
          if (currentProduct.sizeStocks) {
            updateSizeSelection(currentProduct.sizeStocks);
          }
        } else {
          console.log('Varyant bulunamadƒ±! currentProduct.variants:', currentProduct.variants);
          console.log('currentProduct.colorVariants:', currentProduct.colorVariants);
        }
        
        // Stok durumunu g√ºncelle
        updateStockDisplay();
      }
      
      // Stok durumu g√∂stergesini g√ºncelle
      function updateStockDisplay() {
        const stockContainer = document.getElementById('stockContainer');
        const stockText = document.getElementById('stockText');
        
        if (selectedColor && selectedColor.variantIndex !== undefined) {
          if (selectedColor.variantIndex === -1) {
            // Ana √ºr√ºn i√ßin stok durumu
            stockText.textContent = 'Ana √ºr√ºn stok durumu - beden se√ßimi yapƒ±n';
          } else {
            // Varyant i√ßin stok durumu
            stockText.textContent = `${selectedColor.name} rengi stok durumu - beden se√ßimi yapƒ±n`;
          }
        } else {
          stockText.textContent = 'Stok durumu se√ßilen renge g√∂re deƒüi≈üir';
        }
      }

      // Se√ßili varyanta g√∂re beden ve stok bilgilerini g√ºncelle
      function updateSizesAndStock(variantIndex) {
        if (!currentProduct || variantIndex === undefined) return;
        
        // Yeni varyant sistemi kontrol√º
        if (currentProduct.variants && currentProduct.variants[variantIndex]) {
          const variant = currentProduct.variants[variantIndex];
          updateSizesAndStockForVariant(variant);
          updateThumbnailGalleryForVariant(variant);
        } else if (currentProduct.colorVariants && currentProduct.colorVariants[variantIndex]) {
          // Eski sistem i√ßin geriye d√∂n√ºk uyumluluk
          const colorVariant = currentProduct.colorVariants[variantIndex];
          
          // Bedenleri g√ºncelle (eski sistemde sizeStocks kullanƒ±lƒ±yor)
          const sizeContainer = document.getElementById('sizeContainer');
          if (sizeContainer && currentProduct.sizeStocks) {
            sizeContainer.innerHTML = currentProduct.sizeStocks.map(sizeStock => `
              <button class="size-badge px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gold-100 hover:text-gold-700 transition-all duration-200">
                ${sizeStock.size}
              </button>
            `).join('');
          }
          
          // Stok bilgisini g√ºncelle
          const stockContainer = document.getElementById('stockContainer');
          const stockText = document.getElementById('stockText');
          if (stockContainer && stockText) {
            const totalStock = currentProduct.sizeStocks ? 
              currentProduct.sizeStocks.reduce((sum, sizeStock) => sum + sizeStock.stock, 0) : 
              currentProduct.stock || 0;
            
            if (totalStock > 0) {
              stockContainer.querySelector('.w-3.h-3').className = 'w-3 h-3 rounded-full bg-green-500';
              stockText.textContent = `${totalStock} adet stokta mevcut`;
            } else {
              stockContainer.querySelector('.w-3.h-3').className = 'w-3 h-3 rounded-full bg-red-500';
              stockText.textContent = 'Stokta yok';
            }
          }
        }
      }

      // Varyant i√ßin beden ve stok bilgilerini g√ºncelle
      function updateSizesAndStockForVariant(variant) {
        const sizeContainer = document.getElementById('sizeContainer');
        sizeContainer.innerHTML = '';
        
        if (!variant.sizes || variant.sizes.length === 0) {
          sizeContainer.innerHTML = '<p class="text-gray-500">Beden bilgisi bulunmuyor.</p>';
          return;
        }
        
        variant.sizes.forEach(size => {
          const sizeBadge = document.createElement('div');
          sizeBadge.className = `size-badge px-4 py-2 rounded-lg border-2 cursor-pointer ${
            variant.stock > 0 
              ? 'border-gold-400 bg-gold-50 text-gold-700 hover:bg-gold-100' 
              : 'border-gray-300 bg-gray-100 text-gray-400 cursor-not-allowed'
          }`;
          sizeBadge.textContent = size;
          
          if (variant.stock > 0) {
            sizeBadge.addEventListener('click', () => selectSize(size));
          }
          
          sizeContainer.appendChild(sizeBadge);
        });
        
        // Stok bilgisini g√ºncelle
        const stockContainer = document.getElementById('stockContainer');
        const stockText = document.getElementById('stockText');
        if (stockContainer && stockText) {
          if (variant.stock > 0) {
            stockContainer.querySelector('.w-3.h-3').className = 'w-3 h-3 rounded-full bg-green-500';
            stockText.textContent = `${variant.stock} adet stokta mevcut`;
          } else {
            stockContainer.querySelector('.w-3.h-3').className = 'w-3 h-3 rounded-full bg-red-500';
            stockText.textContent = 'Stokta yok';
          }
        }
      }

      // Varyant i√ßin thumbnail galerisini g√ºncelle
      function updateThumbnailGalleryForVariant(variant) {
        const thumbnailGallery = document.getElementById('thumbnailGallery');
        
        if (!variant.images || variant.images.length === 0) return;
        
        // Global allImages dizisini g√ºncelle
        allImages = variant.images.map(img => getImageSrc(img));
        currentImageIndex = 0;
        
        thumbnailGallery.innerHTML = variant.images.map((img, index) => `
          <div class="aspect-square overflow-hidden rounded-lg border-2 ${index === 0 ? 'border-gold-400' : 'border-transparent'} hover:border-gold-400 transition-all duration-300 cursor-pointer group relative" 
               onclick="goToImage(${index})">
            <img src="${getImageSrc(img)}" 
                 alt="${variant.color} renk g√∂rseli ${index + 1}" 
                 class="w-full h-full object-contain group-hover:scale-110 transition-transform duration-300" />
            <div class="absolute inset-0 bg-gold-400/20 opacity-0 group-hover:opacity-100 transition-opacity duration-300"></div>
            ${index === 0 ? '<div class="absolute top-2 left-2 bg-gold-400 text-white text-xs px-2 py-1 rounded-full">Ana</div>' : ''}
          </div>
        `).join('');
        
        // ƒ∞lk g√∂rseli ana g√∂rsel olarak ayarla ve galeri durumunu g√ºncelle
        if (variant.images.length > 0) {
          updateMainImageDisplay();
          updateImageCounter();
          updateImageDots();
          updateNavigationButtons();
        }
      }

      // Cart Functions
      function addToCart() {
        if (!currentProduct) {
          alert('√úr√ºn bilgisi y√ºklenemedi!');
          return;
        }

        if (!selectedColor) {
          alert('L√ºtfen √∂nce bir renk se√ßin!');
          return;
        }

        const cartItem = {
          productId: currentProduct._id,
          name: currentProduct.productName || currentProduct.name,
          price: currentProduct.price,
          imageUrl: selectedColor?.imageUrl || currentProduct.imageUrl,
          selectedColor: selectedColor,
          quantity: 1
        };

        // Yeni varyant sistemi i√ßin ek bilgiler
        if (currentProduct.variants && selectedColor.variantIndex !== undefined) {
          const variant = currentProduct.variants[selectedColor.variantIndex];
          cartItem.stock = variant.stock;
          cartItem.availableSizes = variant.sizes;
        }

        // Get existing cart from localStorage
        let cart = JSON.parse(localStorage.getItem('cart') || '[]');
        
        // Check if product already exists in cart
        const existingItemIndex = cart.findIndex(item => 
          item.productId === cartItem.productId && 
          item.selectedColor?.name === cartItem.selectedColor?.name
        );

        if (existingItemIndex !== -1) {
          // Update quantity if same product and color
          cart[existingItemIndex].quantity += 1;
        } else {
          // Add new item
          cart.push(cartItem);
        }

        // Save to localStorage
        localStorage.setItem('cart', JSON.stringify(cart));
        
        // Show success message
        showCartNotification();
        
        console.log('Added to cart:', cartItem);
        console.log('Current cart:', cart);
      }

      function showCartNotification() {
        const notification = document.createElement('div');
        notification.className = 'fixed top-4 right-4 bg-green-500 text-white px-6 py-3 rounded-lg shadow-lg z-50 transform translate-x-full transition-transform duration-300';
        notification.innerHTML = `
          <div class="flex items-center gap-2">
            <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
              <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"/>
            </svg>
            √úr√ºn sepete eklendi!
          </div>
        `;
        
        document.body.appendChild(notification);
        
        // Animate in
        setTimeout(() => {
          notification.classList.remove('translate-x-full');
        }, 100);
        
        // Animate out and remove
        setTimeout(() => {
          notification.classList.add('translate-x-full');
          setTimeout(() => {
            document.body.removeChild(notification);
          }, 300);
        }, 3000);
      }

      // Error handling function
      function showProductError(message) {
        console.error('‚ùå √úr√ºn hatasƒ± g√∂steriliyor:', message);
        
        // Ana i√ßeriƒüi bul
        const mainContent = document.querySelector('main') || document.querySelector('section');
        if (mainContent) {
          mainContent.innerHTML = `
            <div class="min-h-screen flex items-center justify-center px-4">
              <div class="text-center max-w-md">
                <div class="w-24 h-24 mx-auto mb-6 rounded-full bg-gradient-to-br from-rose-100 to-rose-200 flex items-center justify-center">
                  <svg class="w-12 h-12 text-rose-400" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12"/>
                  </svg>
                </div>
                <h3 class="text-xl font-semibold text-slate-600 mb-2">√úr√ºn Y√ºklenemedi</h3>
                <p class="text-slate-500 mb-6">${message}</p>
                <div class="flex flex-col sm:flex-row gap-3 justify-center">
                  <button onclick="location.reload()" class="px-6 py-3 bg-rose-600 text-white rounded-lg hover:bg-rose-700 transition-colors">
                    Sayfayƒ± Yenile
                  </button>
                  <button onclick="window.location.href='/'" class="px-6 py-3 bg-slate-600 text-white rounded-lg hover:bg-slate-700 transition-colors">
                    Ana Sayfaya D√∂n
                  </button>
                </div>
              </div>
            </div>
          `;
        } else {
          // Fallback: sayfa i√ßeriƒüini temizle ve hata mesajƒ± g√∂ster
          document.body.innerHTML = `
            <div class="min-h-screen flex items-center justify-center px-4 bg-gray-50">
              <div class="text-center max-w-md">
                <div class="w-24 h-24 mx-auto mb-6 rounded-full bg-gradient-to-br from-rose-100 to-rose-200 flex items-center justify-center">
                  <svg class="w-12 h-12 text-rose-400" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12"/>
                  </svg>
                </div>
                <h3 class="text-xl font-semibold text-slate-600 mb-2">√úr√ºn Y√ºklenemedi</h3>
                <p class="text-slate-500 mb-6">${message}</p>
                <div class="flex flex-col sm:flex-row gap-3 justify-center">
                  <button onclick="location.reload()" class="px-6 py-3 bg-rose-600 text-white rounded-lg hover:bg-rose-700 transition-colors">
                    Sayfayƒ± Yenile
                  </button>
                  <button onclick="window.location.href='/'" class="px-6 py-3 bg-slate-600 text-white rounded-lg hover:bg-slate-700 transition-colors">
                    Ana Sayfaya D√∂n
                  </button>
                </div>
              </div>
            </div>
          `;
        }
      }

      // Event Listeners
      document.addEventListener('DOMContentLoaded', function() {
        // Kampanya verilerini y√ºkle
        loadCampaigns();
        
        // Add to Cart button event listener
        const addToCartBtn = document.getElementById('addToCartBtn');
        if (addToCartBtn) {
          addToCartBtn.addEventListener('click', addToCart);
        }

        // Check URL for variant parameter on page load
        const urlParams = new URLSearchParams(window.location.search);
        const variantParam = urlParams.get('variant');
        const colorParam = urlParams.get('color');
        
        if (currentProduct) {
          // Yeni varyant sistemi kontrol√º
          if (variantParam && currentProduct.variants && currentProduct.variants.length > 0) {
            const variantIndex = parseInt(variantParam);
            if (variantIndex >= 0 && variantIndex < currentProduct.variants.length) {
              selectVariant(variantIndex);
            }
          } else if (colorParam && currentProduct.variants && currentProduct.variants.length > 0) {
            // Renk parametresi ile varyant bul
            const variantIndex = currentProduct.variants.findIndex(v => 
              v.color.toLowerCase() === colorParam.toLowerCase()
            );
            if (variantIndex !== -1) {
              const variant = currentProduct.variants[variantIndex];
              const colorElements = document.querySelectorAll('#colorVariantsContainer > div');
              if (colorElements[variantIndex]) {
                selectColor(
                  variant.color, 
                  getColorHex(variant.color), 
                  variant.images[0] || '', 
                  colorElements[variantIndex],
                  variantIndex
                );
              }
            }
          } else if (colorParam && currentProduct.colorVariants && currentProduct.colorVariants.length > 0) {
            // Eski sistem i√ßin geriye d√∂n√ºk uyumluluk
            const colorVariant = currentProduct.colorVariants.find(c => 
              c.name.toLowerCase() === colorParam.toLowerCase() && c.isActive
            );
            if (colorVariant) {
              const colorElements = document.querySelectorAll('#colorVariantsContainer > div');
              colorElements.forEach((element, index) => {
                if (index < currentProduct.colorVariants.length && 
                    currentProduct.colorVariants[index].name.toLowerCase() === colorParam.toLowerCase()) {
                  selectColor(
                    colorVariant.name, 
                    colorVariant.hexCode, 
                    colorVariant.imageUrl || '', 
                    element,
                    index
                  );
                }
              });
            }
          }
        }
      });

      // Kampanya verilerini y√ºkle
      async function loadCampaigns() {
        try {
          const campaigns = await fetch('/api/campaigns');
          const campaignsData = await campaigns.json();
          
          // Aktif kampanyalarƒ± global olarak sakla
          window.activeCampaigns = campaignsData.filter(campaign => campaign.isActive);
          
          console.log('‚úÖ Kampanya verileri y√ºklendi:', window.activeCampaigns.length);
        } catch (error) {
          console.error('‚ùå Kampanya verileri y√ºklenirken hata:', error);
          window.activeCampaigns = [];
        }
      }

      // Mobile Menu Functions
      const mobileMenuBtn = document.getElementById('mobileMenuBtn');
      const mobileMenu = document.getElementById('mobileMenu');
      const closeMobileMenu = document.getElementById('closeMobileMenu');
      const mobileSearch = document.getElementById('mobileSearch');

      // Toggle mobile menu
      mobileMenuBtn?.addEventListener('click', () => {
        mobileMenu.classList.remove('hidden');
        document.body.style.overflow = 'hidden';
      });

      // Close mobile menu
      closeMobileMenu?.addEventListener('click', () => {
        mobileMenu.classList.add('hidden');
        document.body.style.overflow = '';
      });

      // Close mobile menu when clicking outside
      mobileMenu?.addEventListener('click', (e) => {
        if (e.target === mobileMenu) {
          mobileMenu.classList.add('hidden');
          document.body.style.overflow = '';
        }
      });

      // Toggle mobile search
      mobileMenuBtn?.addEventListener('click', () => {
        mobileSearch.classList.toggle('hidden');
      });

      // Yeni varyant sistemi i√ßin fonksiyonlar
      function loadVariants() {
        if (!currentProduct || !currentProduct.variants) return;
        
        const variantsContainer = document.getElementById('variantsContainer');
        if (!variantsContainer) return;
        
        variantsContainer.innerHTML = '';
        
        currentProduct.variants.forEach((variant, index) => {
          const variantCard = createVariantCard(variant, index);
          variantsContainer.appendChild(variantCard);
        });
        
        // ƒ∞lk varyantƒ± varsayƒ±lan olarak se√ß
        if (currentProduct.variants.length > 0) {
          selectVariant(0);
        }
      }
      
      function createVariantCard(variant, index) {
        const card = document.createElement('div');
        card.className = 'border border-slate-200 rounded-xl p-4 bg-slate-50 hover:bg-slate-100 transition-colors cursor-pointer';
        card.dataset.variantIndex = index;
        
        card.innerHTML = `
          <div class="flex items-center justify-between mb-3">
            <h4 class="font-semibold text-slate-800">${variant.color}</h4>
            <div class="flex items-center gap-2">
              <span class="text-sm text-slate-600">Stok: ${variant.stock}</span>
              <div class="w-3 h-3 rounded-full ${variant.stock > 0 ? 'bg-green-500' : 'bg-red-500'}"></div>
            </div>
          </div>
          
          <div class="grid grid-cols-3 gap-2 mb-3">
            ${variant.images && variant.images.length > 0 ? 
              variant.images.slice(0, 3).map(img => `
                <div class="aspect-square overflow-hidden rounded-lg border-2 border-transparent hover:border-gold-400 transition-all duration-300">
                  <img src="${img}" alt="${variant.color} g√∂rseli" class="w-full h-full object-contain" />
                </div>
              `).join('') : 
              '<div class="col-span-3 text-center text-slate-400 text-sm py-4">G√∂rsel yok</div>'
            }
          </div>
          
          <div class="flex flex-wrap gap-2">
            ${variant.sizes && variant.sizes.length > 0 ? 
              variant.sizes.map(size => `
                <span class="px-2 py-1 bg-white text-slate-700 text-xs rounded border">${size}</span>
              `).join('') : 
              '<span class="text-slate-400 text-sm">Beden bilgisi yok</span>'
            }
          </div>
        `;
        
        // Varyant se√ßimi i√ßin click event
        card.addEventListener('click', () => selectVariant(index));
        
        return card;
      }
      
      function selectVariant(variantIndex) {
        if (!currentProduct || !currentProduct.variants || variantIndex >= currentProduct.variants.length) return;
        
        const variant = currentProduct.variants[variantIndex];
        
        // √ñnceki se√ßimi temizle
        document.querySelectorAll('#variantsContainer > div').forEach(card => {
          card.classList.remove('border-gold-400', 'bg-gold-50');
          card.classList.add('border-slate-200', 'bg-slate-50');
        });
        
        // Yeni se√ßimi i≈üaretle
        const selectedCard = document.querySelector(`#variantsContainer > div[data-variant-index="${variantIndex}"]`);
        if (selectedCard) {
          selectedCard.classList.remove('border-slate-200', 'bg-slate-50');
          selectedCard.classList.add('border-gold-400', 'bg-gold-50');
        }
        
        // Se√ßili varyant bilgisini g√ºncelle
        const selectedVariantInfo = document.getElementById('selectedVariantInfo');
        if (selectedVariantInfo) {
          selectedVariantInfo.textContent = `${variant.color} - ${variant.sizes.join(', ')} - Stok: ${variant.stock}`;
        }
        
        // Ana g√∂rseli g√ºncelle
        if (variant.images && variant.images.length > 0) {
          updateMainImage(getImageSrc(variant.images[0]), null, 0);
        }
        
        // Thumbnail galerisini g√ºncelle
        updateThumbnailGalleryForVariant(variant);
        
        // Beden ve stok bilgilerini g√ºncelle
        updateSizesAndStockForVariant(variant);
        
        // URL'i g√ºncelle
        const url = new URL(window.location);
        url.searchParams.set('variant', variantIndex);
        window.history.replaceState({}, '', url);
        
        console.log('Selected variant:', variant);
      }

      // Sayfadaki √ºr√ºn y√ºklendikten sonra URL parametrelerine g√∂re se√ßim uygula
      function applySelectionFromUrl(product) {
        try {
          const urlParams = new URLSearchParams(window.location.search);
          const variantParam = urlParams.get('variant');
          const colorParam = urlParams.get('color');
          
          if (variantParam && product.variants && product.variants.length > 0) {
            const idx = parseInt(variantParam);
            if (!Number.isNaN(idx) && idx >= 0 && idx < product.variants.length) {
              updateToVariantProduct(idx);
            }
          } else if (colorParam) {
            if (product.variants && product.variants.length > 0) {
              const idx = product.variants.findIndex(v => v.color && v.color.toLowerCase() === colorParam.toLowerCase());
              if (idx !== -1) {
                updateToVariantProduct(idx);
              }
            } else if (product.colorVariants && product.colorVariants.length > 0) {
              const idx = product.colorVariants.findIndex(c => c.isActive && c.name && c.name.toLowerCase() === colorParam.toLowerCase());
              if (idx !== -1) {
                const img = product.colorVariants[idx].imageUrl;
                if (img) updateMainImage(img, null, 0);
              }
            }
          }
        } catch (e) {
          console.warn('URL se√ßimleri uygulanamadƒ±:', e);
        }
      }
      
      function updateSizesAndStockForVariant(variant) {
        // Bedenleri g√ºncelle
        const sizeContainer = document.getElementById('sizeContainer');
        if (sizeContainer && variant.sizes) {
          sizeContainer.innerHTML = variant.sizes.map(size => `
            <button class="size-badge px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gold-100 hover:text-gold-700 transition-all duration-200">
              ${size}
            </button>
          `).join('');
        }
        
        // Stok bilgisini g√ºncelle
        const stockContainer = document.getElementById('stockContainer');
        const stockText = document.getElementById('stockText');
        if (stockContainer && stockText) {
          if (variant.stock > 0) {
            stockContainer.querySelector('.w-3.h-3').className = 'w-3 h-3 rounded-full bg-green-500';
            stockText.textContent = `${variant.stock} adet stokta mevcut`;
          } else {
            stockContainer.querySelector('.w-3.h-3').className = 'w-3 h-3 rounded-full bg-red-500';
            stockText.textContent = 'Stokta yok';
          }
        }
      }

      // Yeni varyantlarƒ± y√ºkle
      async function loadProductVariants(productId) {
        try {
          const response = await fetch(`/api/products/${productId}/variants`);
          if (!response.ok) {
            console.log('Varyant verileri alƒ±namadƒ±:', response.status);
            return;
          }
          
          const data = await response.json();
          console.log('Varyant verileri:', data);
          
          // Renk se√ßeneklerini g√∂ster
          displayColorVariants(data);
        } catch (error) {
          console.error('Varyantlar y√ºklenirken hata:', error);
        }
      }

      // Renk se√ßeneklerini g√∂ster
      function displayColorVariants(data) {
        console.log('displayColorVariants yeni fonksiyon √ßaƒürƒ±ldƒ±, data:', data);
        const container = document.getElementById('colorVariantsContainer');
        const section = document.getElementById('colorVariantsSection');
        
        console.log('Container:', container);
        console.log('Section:', section);
        console.log('Data variants:', data?.variants);
        
        if (!container) {
          console.error('colorVariantsContainer elementi bulunamadƒ±!');
          return;
        }
        
        // Ana √ºr√ºn√ºn variants array'ini de kontrol et
        const hasVariants = (data?.variants && data.variants.length > 0) || 
                           (data?.mainProduct?.variants && data.mainProduct.variants.length > 0);
        
        if (!data) {
          console.log('Data yok, section gizleniyor');
          if (section) section.style.display = 'none';
          return;
        }

        // Varyant yoksa bile ana √ºr√ºn√ºn rengini g√∂ster
        if (!hasVariants) {
          console.log('Varyant yok, sadece ana √ºr√ºn√ºn rengi g√∂steriliyor');
        }

        // T√ºm varyantlarƒ± topla ve duplikasyonu √∂nle
        const allVariants = [];
        const seenColors = new Set();
        
        // Ana √ºr√ºn√º her zaman ekle (varyant olsun ya da olmasƒ±n)
        const mainColor = data.mainProduct.mainColor || 'Ana Renk';
        const mainColorHex = data.mainProduct.mainColorHex || '#000000';
        
        if (mainColor && mainColorHex && mainColorHex !== '#000000') {
          allVariants.push({
            _id: data.mainProduct._id,
            name: data.mainProduct.name,
            mainColor: mainColor,
            mainColorHex: mainColorHex,
            imageUrl: data.mainProduct.imageUrl,
            images: data.mainProduct.images,
            isMainProduct: true
          });
          seenColors.add(mainColor.toLowerCase());
        }
        
        // API'den gelen varyantlarƒ± ekle
        if (data.variants && data.variants.length > 0) {
          data.variants.forEach(variant => {
            const colorKey = (variant.mainColor || variant.variantColor || '').toLowerCase();
            if (!seenColors.has(colorKey)) {
              allVariants.push(variant);
              seenColors.add(colorKey);
            }
          });
        }
        
        // Ana √ºr√ºn√ºn variants array'indeki varyantlarƒ± da ekle (sadece g√∂r√ºlmemi≈ü renkler)
        if (data.mainProduct.variants && data.mainProduct.variants.length > 0) {
          data.mainProduct.variants.forEach(variant => {
            const colorKey = variant.color.toLowerCase();
            if (!seenColors.has(colorKey)) {
              allVariants.push({
                _id: `${data.mainProduct._id}_${variant.color}`,
                name: `${data.mainProduct.name} - ${variant.color}`,
                mainColor: variant.color,
                mainColorHex: variant.colorHex || '#000000',
                imageUrl: variant.images && variant.images.length > 0 ? variant.images[0] : data.mainProduct.imageUrl,
                images: variant.images || [],
                isLegacyVariant: true,
                parentId: data.mainProduct._id,
                color: variant.color
              });
              seenColors.add(colorKey);
            }
          });
        }
        
        console.log('Final allVariants:', allVariants);
        console.log('Seen colors:', Array.from(seenColors));
        
        container.innerHTML = '';
        
        allVariants.forEach(variant => {
          const colorElement = document.createElement('div');
          colorElement.className = 'flex flex-col items-center gap-2 cursor-pointer group';
          
          // Ana √ºr√ºn i√ßin tƒ±klama i≈ülevi yok (zaten o sayfadayƒ±z)
          if (variant.isMainProduct) {
            colorElement.className = 'flex flex-col items-center gap-2 group';
            colorElement.style.cursor = 'default';
          } else {
            colorElement.onclick = () => switchToVariant(variant._id);
          }
          
          const currentProductId = window.location.pathname.split('/').pop();
          const isActive = variant._id === currentProductId;
          
          colorElement.innerHTML = `
            <div class="relative">
              <div class="w-12 h-12 rounded-full border-2 ${isActive ? 'border-gold-500 ring-2 ring-gold-200' : 'border-gray-300'} shadow-md overflow-hidden group-hover:scale-110 transition-transform duration-200" 
                   style="background-color: ${variant.mainColorHex}">
              </div>
              ${isActive ? '<div class="absolute -top-1 -right-1 w-4 h-4 bg-gold-500 rounded-full flex items-center justify-center"><svg class="w-2 h-2 text-white" fill="currentColor" viewBox="0 0 20 20"><path d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z"/></svg></div>' : ''}
            </div>
            <span class="text-xs text-center font-medium ${isActive ? 'text-gold-600' : 'text-gray-600'} group-hover:text-gold-600 transition-colors">
              ${variant.mainColor || variant.variantColor}
            </span>
          `;
          
          container.appendChild(colorElement);
        });

        // Se√ßili rengi g√ºncelle
        const selectedColorName = document.getElementById('selectedColorName');
        if (selectedColorName) {
          const currentVariant = allVariants.find(v => v._id === currentProductId);
          if (currentVariant) {
            selectedColorName.textContent = currentVariant.mainColor || currentVariant.variantColor || 'Bilinmiyor';
          } else {
            // Eƒüer mevcut √ºr√ºn varyant listesinde yoksa, ana √ºr√ºn√ºn rengini g√∂ster
            const mainProductColor = data.mainProduct.mainColor || 'Bilinmiyor';
            selectedColorName.textContent = mainProductColor;
          }
        }
        
        // Section'ƒ± g√∂ster
        if (section) section.style.display = 'block';
      }

      // Varyanta ge√ßi≈ü yap
      function switchToVariant(variantId) {
        // Legacy varyant i√ßin renk parametresi ekle
        if (variantId.includes('_')) {
          const [productId, color] = variantId.split('_');
          const currentPath = window.location.pathname;
          const newPath = currentPath.replace(/\/[^\/]+$/, `/${productId}?color=${encodeURIComponent(color)}`);
          window.location.href = newPath;
        } else {
          // Normal varyant √ºr√ºn
          const currentPath = window.location.pathname;
          const newPath = currentPath.replace(/\/[^\/]+$/, `/${variantId}`);
          window.location.href = newPath;
        }
      }
    </script>

  <!-- Footer -->
  <footer class="bg-gradient-to-br from-champagne-50 to-pastel-pink/30 border-t border-champagne-200/50">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12">
      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8">
        <!-- ƒ∞leti≈üim Bilgileri -->
        <div class="space-y-4">
          <h3 class="text-lg font-semibold text-gray-800 mb-4">ƒ∞leti≈üim</h3>
          <div class="space-y-3">
            <div class="flex items-start gap-3">
              <div class="w-5 h-5 bg-gold-100 rounded-full flex items-center justify-center flex-shrink-0 mt-0.5">
                <svg class="w-3 h-3 text-gold-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"/>
                </svg>
              </div>
              <div>
                <p class="text-sm font-medium text-gray-700">Telefon</p>
                <p class="text-sm text-gray-600">+90 506 566 88 54</p>
                <p class="text-sm text-gray-600">+90 543 484 27 15</p>
              </div>
            </div>
            <div class="flex items-start gap-3">
              <div class="w-5 h-5 bg-gold-100 rounded-full flex items-center justify-center flex-shrink-0 mt-0.5">
                <svg class="w-3 h-3 text-gold-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 8l7.89 4.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"/>
                </svg>
              </div>
              <div>
                <p class="text-sm font-medium text-gray-700">E-posta</p>
                <p class="text-sm text-gray-600">htmmoda4@gmail.com</p>
              </div>
            </div>
            <div class="flex items-start gap-3">
              <div class="w-5 h-5 bg-gold-100 rounded-full flex items-center justify-center flex-shrink-0 mt-0.5">
                <svg class="w-3 h-3 text-gold-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"/>
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z"/>
                </svg>
              </div>
              <div>
                <p class="text-sm font-medium text-gray-700">Adres</p>
                <p class="text-sm text-gray-600">Mimar Sinan mahallesi 23 Nisan caddesi hakan sokak No 57/B<br>Merkez / ƒ∞stanbul</p>
              </div>
            </div>
          </div>
        </div>

        <!-- Hƒ±zlƒ± Linkler -->
        <div class="space-y-4">
          <h3 class="text-lg font-semibold text-gray-800 mb-4">Hƒ±zlƒ± Linkler</h3>
          <div class="space-y-3">
            <a href="/" class="block text-sm text-gray-600 hover:text-gold-600 transition-colors duration-200">Ana Sayfa</a>
            <a href="/category?view=categories" class="block text-sm text-gray-600 hover:text-gold-600 transition-colors duration-200">T√ºm Kategoriler</a>
            <a href="/category?new=true" class="block text-sm text-gray-600 hover:text-gold-600 transition-colors duration-200">Yeni √úr√ºnler</a>
            <a href="/category?discount=true" class="block text-sm text-gray-600 hover:text-gold-600 transition-colors duration-200">ƒ∞ndirimler</a>
          </div>
        </div>

        <!-- M√º≈üteri Hizmetleri -->
        <div class="space-y-4">
          <h3 class="text-lg font-semibold text-gray-800 mb-4">M√º≈üteri Hizmetleri</h3>
          <div class="space-y-3">
            <a href="/faq" class="block text-sm text-gray-600 hover:text-gold-600 transition-colors duration-200">Sƒ±k√ßa Sorulan Sorular</a>
            <a href="/faq#shipping" class="block text-sm text-gray-600 hover:text-gold-600 transition-colors duration-200">Kargo ve Teslimat</a>
            <a href="/faq#returns" class="block text-sm text-gray-600 hover:text-gold-600 transition-colors duration-200">ƒ∞ade ve Deƒüi≈üim</a>
            <a href="/faq#privacy" class="block text-sm text-gray-600 hover:text-gold-600 transition-colors duration-200">Gizlilik Politikasƒ±</a>
          </div>
        </div>

        <!-- Sosyal Medya ve ƒ∞leti≈üim -->
        <div class="space-y-4">
          <h3 class="text-lg font-semibold text-gray-800 mb-4">Bizi Takip Edin</h3>
          <div class="space-y-3">
            <a href="https://instagram.com/htm.moda" target="_blank" rel="noopener noreferrer" class="flex items-center gap-3 text-sm text-gray-600 hover:text-gold-600 transition-colors duration-200">
              <div class="w-5 h-5 bg-gold-100 rounded-full flex items-center justify-center">
                <svg class="w-3 h-3 text-gold-600" fill="currentColor" viewBox="0 0 24 24">
                  <path d="M12.017 0C5.396 0 .029 5.367.029 11.987c0 5.079 3.158 9.417 7.618 11.174-.105-.949-.199-2.403.041-3.439.219-.937 1.406-5.957 1.406-5.957s-.359-.72-.359-1.781c0-1.663.967-2.911 2.168-2.911 1.024 0 1.518.769 1.518 1.688 0 1.029-.653 2.567-.992 3.992-.285 1.193.6 2.165 1.775 2.165 2.128 0 3.768-2.245 3.768-5.487 0-2.861-2.063-4.869-5.008-4.869-3.41 0-5.409 2.562-5.409 5.199 0 1.033.394 2.143.889 2.741.099.12.112.225.085.345-.09.375-.293 1.199-.334 1.363-.053.225-.172.271-.402.165-1.495-.69-2.433-2.878-2.433-4.646 0-3.776 2.748-7.252 7.92-7.252 4.158 0 7.392 2.967 7.392 6.923 0 4.135-2.607 7.462-6.233 7.462-1.214 0-2.357-.629-2.746-1.378l-.748 2.853c-.271 1.043-1.002 2.35-1.492 3.146C9.57 23.812 10.763 24.009 12.017 24.009c6.624 0 11.99-5.367 11.99-11.988C24.007 5.367 18.641.001 12.017.001z"/>
                </svg>
              </div>
              <span>Instagram</span>
            </a>
          </div>
        </div>
      </div>

      <!-- Alt Bilgi -->
      <div class="border-t border-champagne-200/50 mt-8 pt-8 text-center">
        <p class="text-sm text-gray-600">
          ¬© 2024 Butik Maƒüaza. T√ºm haklarƒ± saklƒ±dƒ±r. |
          <a href="/faq#privacy" class="text-gold-600 hover:text-gold-700 transition-colors duration-200">Gizlilik Politikasƒ±</a> |
          <a href="/faq#terms" class="text-gold-600 hover:text-gold-700 transition-colors duration-200">Kullanƒ±m ≈ûartlarƒ±</a>
        </p>
      </div>
    </div>
  </footer>
  </body>
</html> 
